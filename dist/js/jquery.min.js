function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}var Util=function(){function t(t){return{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function e(){return{bindType:s.end,delegateType:s.end,handle:function(t){if($(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}}}function i(){if(window.QUnit)return!1;var t=document.createElement("bootstrap");for(var e in r)if(void 0!==t.style[e])return{end:r[e]};return!1}function n(t){var e=this,i=!1;return $(this).one(o.TRANSITION_END,function(){i=!0}),setTimeout(function(){i||o.triggerTransitionEnd(e)},t),this}var s=!1,r={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},o={TRANSITION_END:"bsTransitionEnd",getUID:function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},getSelectorFromElement:function(t){var e=t.getAttribute("data-target");e&&"#"!==e||(e=t.getAttribute("href")||"");try{return $(document).find(e).length>0?e:null}catch(t){return null}},reflow:function(t){return t.offsetHeight},triggerTransitionEnd:function(t){$(t).trigger(s.end)},supportsTransitionEnd:function(){return Boolean(s)},isElement:function(t){return(t[0]||t).nodeType},typeCheckConfig:function(e,i,n){for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){var r=n[s],a=i[s],l=a&&o.isElement(a)?"element":t(a);if(!new RegExp(r).test(l))throw new Error(e.toUpperCase()+': Option "'+s+'" provided type "'+l+'" but expected type "'+r+'".')}}};return function(){s=i(),$.fn.emulateTransitionEnd=n,o.supportsTransitionEnd()&&($.event.special[o.TRANSITION_END]=e())}(),o}($),Collapse=function(){var t="collapse",e="bs.collapse",i=$.fn[t],n={toggle:!0,parent:""},s={toggle:"boolean",parent:"(string|element)"},r={SHOW:"show.bs.collapse",SHOWN:"shown.bs.collapse",HIDE:"hide.bs.collapse",HIDDEN:"hidden.bs.collapse",CLICK_DATA_API:"click.bs.collapse.data-api"},o={SHOW:"show",COLLAPSE:"collapse",COLLAPSING:"collapsing",COLLAPSED:"collapsed"},a={WIDTH:"width",HEIGHT:"height"},l={ACTIVES:".show, .collapsing",DATA_TOGGLE:'[data-toggle="collapse"]'},u=function(){function i(t,e){this._isTransitioning=!1,this._element=t,this._config=this._getConfig(e),this._triggerArray=$.makeArray($('[data-toggle="collapse"][href="#'+t.id+'"],[data-toggle="collapse"][data-target="#'+t.id+'"]'));for(var i=$(l.DATA_TOGGLE),n=0;n<i.length;n++){var s=i[n],r=Util.getSelectorFromElement(s);null!==r&&$(r).filter(t).length>0&&this._triggerArray.push(s)}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var u=i.prototype;return u.toggle=function(){$(this._element).hasClass(o.SHOW)?this.hide():this.show()},u.show=function(){var t=this;if(!this._isTransitioning&&!$(this._element).hasClass(o.SHOW)){var n,s;if(this._parent&&(n=$.makeArray($(this._parent).children().children(l.ACTIVES)),n.length||(n=null)),!(n&&(s=$(n).data(e))&&s._isTransitioning)){var a=$.Event(r.SHOW);if($(this._element).trigger(a),!a.isDefaultPrevented()){n&&(i._jQueryInterface.call($(n),"hide"),s||$(n).data(e,null));var u=this._getDimension();$(this._element).removeClass(o.COLLAPSE).addClass(o.COLLAPSING),this._element.style[u]=0,this._triggerArray.length&&$(this._triggerArray).removeClass(o.COLLAPSED).attr("aria-expanded",!0),this.setTransitioning(!0);var h=function(){$(t._element).removeClass(o.COLLAPSING).addClass(o.COLLAPSE).addClass(o.SHOW),t._element.style[u]="",t.setTransitioning(!1),$(t._element).trigger(r.SHOWN)};if(!Util.supportsTransitionEnd())return void h();var c=u[0].toUpperCase()+u.slice(1),d="scroll"+c;$(this._element).one(Util.TRANSITION_END,h).emulateTransitionEnd(600),this._element.style[u]=this._element[d]+"px"}}}},u.hide=function(){var t=this;if(!this._isTransitioning&&$(this._element).hasClass(o.SHOW)){var e=$.Event(r.HIDE);if($(this._element).trigger(e),!e.isDefaultPrevented()){var i=this._getDimension();if(this._element.style[i]=this._element.getBoundingClientRect()[i]+"px",Util.reflow(this._element),$(this._element).addClass(o.COLLAPSING).removeClass(o.COLLAPSE).removeClass(o.SHOW),this._triggerArray.length)for(var n=0;n<this._triggerArray.length;n++){var s=this._triggerArray[n],a=Util.getSelectorFromElement(s);if(null!==a){var l=$(a);l.hasClass(o.SHOW)||$(s).addClass(o.COLLAPSED).attr("aria-expanded",!1)}}this.setTransitioning(!0);var u=function(){t.setTransitioning(!1),$(t._element).removeClass(o.COLLAPSING).addClass(o.COLLAPSE).trigger(r.HIDDEN)};if(this._element.style[i]="",!Util.supportsTransitionEnd())return void u();$(this._element).one(Util.TRANSITION_END,u).emulateTransitionEnd(600)}}},u.setTransitioning=function(t){this._isTransitioning=t},u.dispose=function(){$.removeData(this._element,e),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},u._getConfig=function(e){return e=$.extend({},n,e),e.toggle=Boolean(e.toggle),Util.typeCheckConfig(t,e,s),e},u._getDimension=function(){return $(this._element).hasClass(a.WIDTH)?a.WIDTH:a.HEIGHT},u._getParent=function(){var t=this,e=null;Util.isElement(this._config.parent)?(e=this._config.parent,void 0!==this._config.parent.jquery&&(e=this._config.parent[0])):e=$(this._config.parent)[0];var n='[data-toggle="collapse"][data-parent="'+this._config.parent+'"]';return $(e).find(n).each(function(e,n){t._addAriaAndCollapsedClass(i._getTargetFromElement(n),[n])}),e},u._addAriaAndCollapsedClass=function(t,e){if(t){var i=$(t).hasClass(o.SHOW);e.length&&$(e).toggleClass(o.COLLAPSED,!i).attr("aria-expanded",i)}},i._getTargetFromElement=function(t){var e=Util.getSelectorFromElement(t);return e?$(e)[0]:null},i._jQueryInterface=function(t){return this.each(function(){var s=$(this),r=s.data(e),o=$.extend({},n,s.data(),"object"==typeof t&&t);if(!r&&o.toggle&&/show|hide/.test(t)&&(o.toggle=!1),r||(r=new i(this,o),s.data(e,r)),"string"==typeof t){if(void 0===r[t])throw new Error('No method named "'+t+'"');r[t]()}})},_createClass(i,null,[{key:"VERSION",get:function(){return"4.0.0-beta.2"}},{key:"Default",get:function(){return n}}]),i}();return $(document).on(r.CLICK_DATA_API,l.DATA_TOGGLE,function(t){"A"===t.currentTarget.tagName&&t.preventDefault();var i=$(this),n=Util.getSelectorFromElement(this);$(n).each(function(){var t=$(this),n=t.data(e),s=n?"toggle":i.data();u._jQueryInterface.call(t,s)})}),$.fn[t]=u._jQueryInterface,$.fn[t].Constructor=u,$.fn[t].noConflict=function(){return $.fn[t]=i,u._jQueryInterface},u}($),Modal=function(){var t="modal",e=".bs.modal",i=$.fn[t],n={backdrop:!0,keyboard:!0,focus:!0,show:!0},s={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},r={HIDE:"hide.bs.modal",HIDDEN:"hidden.bs.modal",SHOW:"show.bs.modal",SHOWN:"shown.bs.modal",FOCUSIN:"focusin.bs.modal",RESIZE:"resize.bs.modal",CLICK_DISMISS:"click.dismiss.bs.modal",KEYDOWN_DISMISS:"keydown.dismiss.bs.modal",MOUSEUP_DISMISS:"mouseup.dismiss.bs.modal",MOUSEDOWN_DISMISS:"mousedown.dismiss.bs.modal",CLICK_DATA_API:"click.bs.modal.data-api"},o={SCROLLBAR_MEASURER:"modal-scrollbar-measure",BACKDROP:"modal-backdrop",OPEN:"modal-open",FADE:"fade",SHOW:"show"},a={DIALOG:".modal-dialog",DATA_TOGGLE:'[data-toggle="modal"]',DATA_DISMISS:'[data-dismiss="modal"]',FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"},l=function(){function i(t,e){this._config=this._getConfig(e),this._element=t,this._dialog=$(t).find(a.DIALOG)[0],this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._originalBodyPadding=0,this._scrollbarWidth=0}var l=i.prototype;return l.toggle=function(t){return this._isShown?this.hide():this.show(t)},l.show=function(t){var e=this;if(!this._isTransitioning&&!this._isShown){Util.supportsTransitionEnd()&&$(this._element).hasClass(o.FADE)&&(this._isTransitioning=!0);var i=$.Event(r.SHOW,{relatedTarget:t});$(this._element).trigger(i),this._isShown||i.isDefaultPrevented()||(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),$(document.body).addClass(o.OPEN),this._setEscapeEvent(),this._setResizeEvent(),$(this._element).on(r.CLICK_DISMISS,a.DATA_DISMISS,function(t){return e.hide(t)}),$(this._dialog).on(r.MOUSEDOWN_DISMISS,function(){$(e._element).one(r.MOUSEUP_DISMISS,function(t){$(t.target).is(e._element)&&(e._ignoreBackdropClick=!0)})}),this._showBackdrop(function(){return e._showElement(t)}))}},l.hide=function(t){var e=this;if(t&&t.preventDefault(),!this._isTransitioning&&this._isShown){var i=$.Event(r.HIDE);if($(this._element).trigger(i),this._isShown&&!i.isDefaultPrevented()){this._isShown=!1;var n=Util.supportsTransitionEnd()&&$(this._element).hasClass(o.FADE);n&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),$(document).off(r.FOCUSIN),$(this._element).removeClass(o.SHOW),$(this._element).off(r.CLICK_DISMISS),$(this._dialog).off(r.MOUSEDOWN_DISMISS),n?$(this._element).one(Util.TRANSITION_END,function(t){return e._hideModal(t)}).emulateTransitionEnd(300):this._hideModal()}}},l.dispose=function(){$.removeData(this._element,"bs.modal"),$(window,document,this._element,this._backdrop).off(e),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._scrollbarWidth=null},l.handleUpdate=function(){this._adjustDialog()},l._getConfig=function(e){return e=$.extend({},n,e),Util.typeCheckConfig(t,e,s),e},l._showElement=function(t){var e=this,i=Util.supportsTransitionEnd()&&$(this._element).hasClass(o.FADE);this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.scrollTop=0,i&&Util.reflow(this._element),$(this._element).addClass(o.SHOW),this._config.focus&&this._enforceFocus();var n=$.Event(r.SHOWN,{relatedTarget:t}),s=function(){e._config.focus&&e._element.focus(),e._isTransitioning=!1,$(e._element).trigger(n)};i?$(this._dialog).one(Util.TRANSITION_END,s).emulateTransitionEnd(300):s()},l._enforceFocus=function(){var t=this;$(document).off(r.FOCUSIN).on(r.FOCUSIN,function(e){document===e.target||t._element===e.target||$(t._element).has(e.target).length||t._element.focus()})},l._setEscapeEvent=function(){var t=this;this._isShown&&this._config.keyboard?$(this._element).on(r.KEYDOWN_DISMISS,function(e){27===e.which&&(e.preventDefault(),t.hide())}):this._isShown||$(this._element).off(r.KEYDOWN_DISMISS)},l._setResizeEvent=function(){var t=this;this._isShown?$(window).on(r.RESIZE,function(e){return t.handleUpdate(e)}):$(window).off(r.RESIZE)},l._hideModal=function(){var t=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._isTransitioning=!1,this._showBackdrop(function(){$(document.body).removeClass(o.OPEN),t._resetAdjustments(),t._resetScrollbar(),$(t._element).trigger(r.HIDDEN)})},l._removeBackdrop=function(){this._backdrop&&($(this._backdrop).remove(),this._backdrop=null)},l._showBackdrop=function(t){var e=this,i=$(this._element).hasClass(o.FADE)?o.FADE:"";if(this._isShown&&this._config.backdrop){var n=Util.supportsTransitionEnd()&&i;if(this._backdrop=document.createElement("div"),this._backdrop.className=o.BACKDROP,i&&$(this._backdrop).addClass(i),$(this._backdrop).appendTo(document.body),$(this._element).on(r.CLICK_DISMISS,function(t){if(e._ignoreBackdropClick)return void(e._ignoreBackdropClick=!1);t.target===t.currentTarget&&("static"===e._config.backdrop?e._element.focus():e.hide())}),n&&Util.reflow(this._backdrop),$(this._backdrop).addClass(o.SHOW),!t)return;if(!n)return void t();$(this._backdrop).one(Util.TRANSITION_END,t).emulateTransitionEnd(150)}else if(!this._isShown&&this._backdrop){$(this._backdrop).removeClass(o.SHOW);var s=function(){e._removeBackdrop(),t&&t()};Util.supportsTransitionEnd()&&$(this._element).hasClass(o.FADE)?$(this._backdrop).one(Util.TRANSITION_END,s).emulateTransitionEnd(150):s()}else t&&t()},l._adjustDialog=function(){var t=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&t&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!t&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},l._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},l._checkScrollbar=function(){var t=document.body.getBoundingClientRect();this._isBodyOverflowing=t.left+t.right<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},l._setScrollbar=function(){var t=this;if(this._isBodyOverflowing){$(a.FIXED_CONTENT).each(function(e,i){var n=$(i)[0].style.paddingRight,s=$(i).css("padding-right");$(i).data("padding-right",n).css("padding-right",parseFloat(s)+t._scrollbarWidth+"px")}),$(a.STICKY_CONTENT).each(function(e,i){var n=$(i)[0].style.marginRight,s=$(i).css("margin-right");$(i).data("margin-right",n).css("margin-right",parseFloat(s)-t._scrollbarWidth+"px")}),$(a.NAVBAR_TOGGLER).each(function(e,i){var n=$(i)[0].style.marginRight,s=$(i).css("margin-right");$(i).data("margin-right",n).css("margin-right",parseFloat(s)+t._scrollbarWidth+"px")});var e=document.body.style.paddingRight,i=$("body").css("padding-right");$("body").data("padding-right",e).css("padding-right",parseFloat(i)+this._scrollbarWidth+"px")}},l._resetScrollbar=function(){$(a.FIXED_CONTENT).each(function(t,e){var i=$(e).data("padding-right");void 0!==i&&$(e).css("padding-right",i).removeData("padding-right")}),$(a.STICKY_CONTENT+", "+a.NAVBAR_TOGGLER).each(function(t,e){var i=$(e).data("margin-right");void 0!==i&&$(e).css("margin-right",i).removeData("margin-right")});var t=$("body").data("padding-right");void 0!==t&&$("body").css("padding-right",t).removeData("padding-right")},l._getScrollbarWidth=function(){var t=document.createElement("div");t.className=o.SCROLLBAR_MEASURER,document.body.appendChild(t);var e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e},i._jQueryInterface=function(t,e){return this.each(function(){var n=$(this).data("bs.modal"),s=$.extend({},i.Default,$(this).data(),"object"==typeof t&&t);if(n||(n=new i(this,s),$(this).data("bs.modal",n)),"string"==typeof t){if(void 0===n[t])throw new Error('No method named "'+t+'"');n[t](e)}else s.show&&n.show(e)})},_createClass(i,null,[{key:"VERSION",get:function(){return"4.0.0-beta.2"}},{key:"Default",get:function(){return n}}]),i}();return $(document).on(r.CLICK_DATA_API,a.DATA_TOGGLE,function(t){var e,i=this,n=Util.getSelectorFromElement(this);n&&(e=$(n)[0]);var s=$(e).data("bs.modal")?"toggle":$.extend({},$(e).data(),$(this).data());"A"!==this.tagName&&"AREA"!==this.tagName||t.preventDefault();var o=$(e).one(r.SHOW,function(t){t.isDefaultPrevented()||o.one(r.HIDDEN,function(){$(i).is(":visible")&&i.focus()})});l._jQueryInterface.call($(e),s,this)}),$.fn[t]=l._jQueryInterface,$.fn[t].Constructor=l,$.fn[t].noConflict=function(){return $.fn[t]=i,l._jQueryInterface},l}($),_slice=Array.prototype.slice,_slicedToArray=function(){function t(t,e){var i=[],n=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){s=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(s)throw r}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t};!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):t.parsley=e(t.jQuery)}(this,function(t){"use strict";function e(t,e){return t.parsleyAdaptedCallback||(t.parsleyAdaptedCallback=function(){var i=Array.prototype.slice.call(arguments,0);i.unshift(this),t.apply(e||$,i)}),t.parsleyAdaptedCallback}function i(t){return 0===t.lastIndexOf(q,0)?t.substr(q.length):t}function n(){var e=this,i=window||global;_extends(this,{isNativeEvent:function(t){return t.originalEvent&&!1!==t.originalEvent.isTrusted},fakeInputEvent:function(i){e.isNativeEvent(i)&&t(i.target).trigger("input")},misbehaves:function(i){e.isNativeEvent(i)&&(e.behavesOk(i),t(document).on("change.inputevent",i.data.selector,e.fakeInputEvent),e.fakeInputEvent(i))},behavesOk:function(i){e.isNativeEvent(i)&&t(document).off("input.inputevent",i.data.selector,e.behavesOk).off("change.inputevent",i.data.selector,e.misbehaves)},install:function(){if(!i.inputEventPatched){i.inputEventPatched="0.0.3";for(var n=["select",'input[type="checkbox"]','input[type="radio"]','input[type="file"]'],s=0;s<n.length;s++){var r=n[s];t(document).on("input.inputevent",r,{selector:r},e.behavesOk).on("change.inputevent",r,{selector:r},e.misbehaves)}}},uninstall:function(){delete i.inputEventPatched,t(document).off(".inputevent")}})}var s=1,r={},o={attr:function(t,e,i){var n,s,r,o=new RegExp("^"+e,"i");if(void 0===i)i={};else for(n in i)i.hasOwnProperty(n)&&delete i[n];if(!t)return i;for(r=t.attributes,n=r.length;n--;)(s=r[n])&&s.specified&&o.test(s.name)&&(i[this.camelize(s.name.slice(e.length))]=this.deserializeValue(s.value));return i},checkAttr:function(t,e,i){return t.hasAttribute(e+i)},setAttr:function(t,e,i,n){t.setAttribute(this.dasherize(e+i),String(n))},getType:function(t){return t.getAttribute("type")||"text"},generateID:function(){return""+s++},deserializeValue:function(t){var e;try{return t?"true"==t||"false"!=t&&("null"==t?null:isNaN(e=Number(t))?/^[\[\{]/.test(t)?JSON.parse(t):t:e):t}catch(e){return t}},camelize:function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},dasherize:function(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()},warn:function(){var t;window.console&&"function"==typeof window.console.warn&&(t=window.console).warn.apply(t,arguments)},warnOnce:function(t){r[t]||(r[t]=!0,this.warn.apply(this,arguments))},_resetWarnings:function(){r={}},trimString:function(t){return t.replace(/^\s+|\s+$/g,"")},parse:{date:function(t){var e=t.match(/^(\d{4,})-(\d\d)-(\d\d)$/);if(!e)return null;var i=e.map(function(t){return parseInt(t,10)}),n=_slicedToArray(i,4),s=(n[0],n[1]),r=n[2],o=n[3],a=new Date(s,r-1,o);return a.getFullYear()!==s||a.getMonth()+1!==r||a.getDate()!==o?null:a},string:function(t){return t},integer:function(t){return isNaN(t)?null:parseInt(t,10)},number:function(t){if(isNaN(t))throw null;return parseFloat(t)},boolean:function(t){return!/^\s*false\s*$/i.test(t)},object:function(t){return o.deserializeValue(t)},regexp:function(t){var e="";return/^\/.*\/(?:[gimy]*)$/.test(t)?(e=t.replace(/.*\/([gimy]*)$/,"$1"),t=t.replace(new RegExp("^/(.*?)/"+e+"$"),"$1")):t="^"+t+"$",new RegExp(t,e)}},parseRequirement:function(t,e){var i=this.parse[t||"string"];if(!i)throw'Unknown requirement specification: "'+t+'"';var n=i(e);if(null===n)throw"Requirement is not a "+t+': "'+e+'"';return n},namespaceEvents:function(e,i){return e=this.trimString(e||"").split(/\s+/),e[0]?t.map(e,function(t){return t+"."+i}).join(" "):""},difference:function(e,i){var n=[];return t.each(e,function(t,e){-1==i.indexOf(e)&&n.push(e)}),n},all:function(e){return t.when.apply(t,_toConsumableArray(e).concat([42,42]))},objectCreate:Object.create||function(){var t=function(){};return function(e){if(arguments.length>1)throw Error("Second argument not supported");if("object"!=typeof e)throw TypeError("Argument must be an object");t.prototype=e;var i=new t;return t.prototype=null,i}}(),_SubmitSelector:'input[type="submit"], button:submit'},a={namespace:"data-parsley-",inputs:"input, textarea, select",excluded:"input[type=button], input[type=submit], input[type=reset], input[type=hidden]",priorityEnabled:!0,multiple:null,group:null,uiEnabled:!0,validationThreshold:3,focus:"first",trigger:!1,triggerAfterFailure:"input",errorClass:"parsley-error",successClass:"parsley-success",classHandler:function(t){},errorsContainer:function(t){},errorsWrapper:'<ul class="parsley-errors-list"></ul>',errorTemplate:"<li></li>"},l=function(){this.__id__=o.generateID()};l.prototype={asyncSupport:!0,_pipeAccordingToValidationResult:function(){var e=this,i=function(){var i=t.Deferred();return!0!==e.validationResult&&i.reject(),i.resolve().promise()};return[i,i]},actualizeOptions:function(){return o.attr(this.element,this.options.namespace,this.domOptions),this.parent&&this.parent.actualizeOptions&&this.parent.actualizeOptions(),this},_resetOptions:function(t){this.domOptions=o.objectCreate(this.parent.options),this.options=o.objectCreate(this.domOptions);for(var e in t)t.hasOwnProperty(e)&&(this.options[e]=t[e]);this.actualizeOptions()},_listeners:null,on:function(t,e){return this._listeners=this._listeners||{},(this._listeners[t]=this._listeners[t]||[]).push(e),this},subscribe:function(e,i){t.listenTo(this,e.toLowerCase(),i)},off:function(t,e){var i=this._listeners&&this._listeners[t];if(i)if(e)for(var n=i.length;n--;)i[n]===e&&i.splice(n,1);else delete this._listeners[t];return this},unsubscribe:function(e,i){t.unsubscribeTo(this,e.toLowerCase())},trigger:function(t,e,i){e=e||this;var n,s=this._listeners&&this._listeners[t];if(s)for(var r=s.length;r--;)if(!1===(n=s[r].call(e,e,i)))return n;return!this.parent||this.parent.trigger(t,e,i)},asyncIsValid:function(t,e){return o.warnOnce("asyncIsValid is deprecated; please use whenValid instead"),this.whenValid({group:t,force:e})},_findRelated:function(){return this.options.multiple?t(this.parent.element.querySelectorAll("["+this.options.namespace+'multiple="'+this.options.multiple+'"]')):this.$element}};var u=function(t,e){var i=t.match(/^\s*\[(.*)\]\s*$/);if(!i)throw'Requirement is not an array: "'+t+'"';var n=i[1].split(",").map(o.trimString);if(n.length!==e)throw"Requirement has "+n.length+" values when "+e+" are needed";return n},h=function(t,e,i){var n=null,s={};for(var r in t)if(r){var a=i(r);"string"==typeof a&&(a=o.parseRequirement(t[r],a)),s[r]=a}else n=o.parseRequirement(t[r],e);return[n,s]},c=function(e){t.extend(!0,this,e)};c.prototype={validate:function(t,e){if(this.fn)return arguments.length>3&&(e=[].slice.call(arguments,1,-1)),this.fn(t,e);if(Array.isArray(t)){if(!this.validateMultiple)throw"Validator `"+this.name+"` does not handle multiple values";return this.validateMultiple.apply(this,arguments)}var i=arguments[arguments.length-1];if(this.validateDate&&i._isDateInput())return arguments[0]=o.parse.date(arguments[0]),null!==arguments[0]&&this.validateDate.apply(this,arguments);if(this.validateNumber)return!isNaN(t)&&(arguments[0]=parseFloat(arguments[0]),this.validateNumber.apply(this,arguments));if(this.validateString)return this.validateString.apply(this,arguments);throw"Validator `"+this.name+"` only handles multiple values"},parseRequirements:function(e,i){if("string"!=typeof e)return Array.isArray(e)?e:[e];var n=this.requirementType;if(Array.isArray(n)){for(var s=u(e,n.length),r=0;r<s.length;r++)s[r]=o.parseRequirement(n[r],s[r]);return s}return t.isPlainObject(n)?h(n,e,i):[o.parseRequirement(n,e)]},requirementType:"string",priority:2};var d=function(t,e){this.__class__="ValidatorRegistry",this.locale="en",this.init(t||{},e||{})},p={email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,number:/^-?(\d*\.)?\d+(e[-+]?\d+)?$/i,integer:/^-?\d+$/,digits:/^\d+$/,alphanum:/^\w+$/i,date:{test:function(t){return null!==o.parse.date(t)}},url:new RegExp("^(?:(?:https?|ftp)://)?(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:/\\S*)?$","i")};p.range=p.number;var f=function(t){var e=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},g=function(t,e){return e.map(o.parse[t])},m=function(t,e){return function(i){for(var n=arguments.length,s=Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];return s.pop(),e.apply(void 0,[i].concat(_toConsumableArray(g(t,s))))}},y=function(t){return{validateDate:m("date",t),validateNumber:m("number",t),requirementType:t.length<=2?"string":["string","string"],priority:30}};d.prototype={init:function(t,e){this.catalog=e,this.validators=_extends({},this.validators);for(var i in t)this.addValidator(i,t[i].fn,t[i].priority);window.Parsley.trigger("parsley:validator:init")},setLocale:function(t){if(void 0===this.catalog[t])throw new Error(t+" is not available in the catalog");return this.locale=t,this},addCatalog:function(t,e,i){return"object"==typeof e&&(this.catalog[t]=e),!0===i?this.setLocale(t):this},addMessage:function(t,e,i){return void 0===this.catalog[t]&&(this.catalog[t]={}),this.catalog[t][e]=i,this},addMessages:function(t,e){for(var i in e)this.addMessage(t,i,e[i]);return this},addValidator:function(t,e,i){if(this.validators[t])o.warn('Validator "'+t+'" is already defined.');else if(a.hasOwnProperty(t))return void o.warn('"'+t+'" is a restricted keyword and is not a valid validator name.');return this._setValidator.apply(this,arguments)},hasValidator:function(t){return!!this.validators[t]},updateValidator:function(t,e,i){return this.validators[t]?this._setValidator.apply(this,arguments):(o.warn('Validator "'+t+'" is not already defined.'),this.addValidator.apply(this,arguments))},removeValidator:function(t){return this.validators[t]||o.warn('Validator "'+t+'" is not defined.'),delete this.validators[t],this},_setValidator:function(t,e,i){"object"!=typeof e&&(e={fn:e,priority:i}),e.validate||(e=new c(e)),this.validators[t]=e;for(var n in e.messages||{})this.addMessage(n,t,e.messages[n]);return this},getErrorMessage:function(t){var e;if("type"===t.name){e=(this.catalog[this.locale][t.name]||{})[t.requirements]}else e=this.formatMessage(this.catalog[this.locale][t.name],t.requirements);return e||this.catalog[this.locale].defaultMessage||this.catalog.en.defaultMessage},formatMessage:function(t,e){if("object"==typeof e){for(var i in e)t=this.formatMessage(t,e[i]);return t}return"string"==typeof t?t.replace(/%s/i,e):""},validators:{notblank:{validateString:function(t){return/\S/.test(t)},priority:2},required:{validateMultiple:function(t){return t.length>0},validateString:function(t){return/\S/.test(t)},priority:512},type:{validateString:function(t,e){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n=i.step,s=void 0===n?"any":n,r=i.base,o=void 0===r?0:r,a=p[e];if(!a)throw new Error("validator type `"+e+"` is not supported");if(!a.test(t))return!1;if("number"===e&&!/^any$/i.test(s||"")){var l=Number(t),u=Math.max(f(s),f(o));if(f(l)>u)return!1;var h=function(t){return Math.round(t*Math.pow(10,u))};if((h(l)-h(o))%h(s)!=0)return!1}return!0},requirementType:{"":"string",step:"string",base:"number"},priority:256},pattern:{validateString:function(t,e){return e.test(t)},requirementType:"regexp",priority:64},minlength:{validateString:function(t,e){return t.length>=e},requirementType:"integer",priority:30},maxlength:{validateString:function(t,e){return t.length<=e},requirementType:"integer",priority:30},length:{validateString:function(t,e,i){return t.length>=e&&t.length<=i},requirementType:["integer","integer"],priority:30},mincheck:{validateMultiple:function(t,e){return t.length>=e},requirementType:"integer",priority:30},maxcheck:{validateMultiple:function(t,e){return t.length<=e},requirementType:"integer",priority:30},check:{validateMultiple:function(t,e,i){return t.length>=e&&t.length<=i},requirementType:["integer","integer"],priority:30},min:y(function(t,e){return t>=e}),max:y(function(t,e){return t<=e}),range:y(function(t,e,i){return t>=e&&t<=i}),equalto:{validateString:function(e,i){var n=t(i);return n.length?e===n.val():e===i},priority:256}}};var v={},b=function t(e,i,n){for(var s=[],r=[],o=0;o<e.length;o++){for(var a=!1,l=0;l<i.length;l++)if(e[o].assert.name===i[l].assert.name){a=!0;break}a?r.push(e[o]):s.push(e[o])}return{kept:r,added:s,removed:n?[]:t(i,e,!0).added}};v.Form={_actualizeTriggers:function(){var t=this;this.$element.on("submit.Parsley",function(e){t.onSubmitValidate(e)}),this.$element.on("click.Parsley",o._SubmitSelector,function(e){t.onSubmitButton(e)}),!1!==this.options.uiEnabled&&this.element.setAttribute("novalidate","")},focus:function(){if(this._focusedField=null,!0===this.validationResult||"none"===this.options.focus)return null;for(var t=0;t<this.fields.length;t++){var e=this.fields[t];if(!0!==e.validationResult&&e.validationResult.length>0&&void 0===e.options.noFocus&&(this._focusedField=e.$element,"first"===this.options.focus))break}return null===this._focusedField?null:this._focusedField.focus()},_destroyUI:function(){this.$element.off(".Parsley")}},v.Field={_reflowUI:function(){if(this._buildUI(),this._ui){var t=b(this.validationResult,this._ui.lastValidationResult);this._ui.lastValidationResult=this.validationResult,this._manageStatusClass(),this._manageErrorsMessages(t),this._actualizeTriggers(),!t.kept.length&&!t.added.length||this._failedOnce||(this._failedOnce=!0,this._actualizeTriggers())}},getErrorsMessages:function(){if(!0===this.validationResult)return[];for(var t=[],e=0;e<this.validationResult.length;e++)t.push(this.validationResult[e].errorMessage||this._getErrorMessage(this.validationResult[e].assert));return t},addError:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=e.message,n=e.assert,s=e.updateClass,r=void 0===s||s;this._buildUI(),this._addError(t,{message:i,assert:n}),r&&this._errorClass()},updateError:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=e.message,n=e.assert,s=e.updateClass,r=void 0===s||s;this._buildUI(),this._updateError(t,{message:i,assert:n}),r&&this._errorClass()},removeError:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=e.updateClass,n=void 0===i||i;this._buildUI(),this._removeError(t),n&&this._manageStatusClass()},_manageStatusClass:function(){
this.hasConstraints()&&this.needsValidation()&&!0===this.validationResult?this._successClass():this.validationResult.length>0?this._errorClass():this._resetClass()},_manageErrorsMessages:function(e){if(void 0===this.options.errorsMessagesDisabled){if(void 0!==this.options.errorMessage)return e.added.length||e.kept.length?(this._insertErrorWrapper(),0===this._ui.$errorsWrapper.find(".parsley-custom-error-message").length&&this._ui.$errorsWrapper.append(t(this.options.errorTemplate).addClass("parsley-custom-error-message")),this._ui.$errorsWrapper.addClass("filled").find(".parsley-custom-error-message").html(this.options.errorMessage)):this._ui.$errorsWrapper.removeClass("filled").find(".parsley-custom-error-message").remove();for(var i=0;i<e.removed.length;i++)this._removeError(e.removed[i].assert.name);for(i=0;i<e.added.length;i++)this._addError(e.added[i].assert.name,{message:e.added[i].errorMessage,assert:e.added[i].assert});for(i=0;i<e.kept.length;i++)this._updateError(e.kept[i].assert.name,{message:e.kept[i].errorMessage,assert:e.kept[i].assert})}},_addError:function(e,i){var n=i.message,s=i.assert;this._insertErrorWrapper(),this._ui.$errorsWrapper.addClass("filled").append(t(this.options.errorTemplate).addClass("parsley-"+e).html(n||this._getErrorMessage(s)))},_updateError:function(t,e){var i=e.message,n=e.assert;this._ui.$errorsWrapper.addClass("filled").find(".parsley-"+t).html(i||this._getErrorMessage(n))},_removeError:function(t){this._ui.$errorsWrapper.removeClass("filled").find(".parsley-"+t).remove()},_getErrorMessage:function(t){var e=t.name+"Message";return void 0!==this.options[e]?window.Parsley.formatMessage(this.options[e],t.requirements):window.Parsley.getErrorMessage(t)},_buildUI:function(){if(!this._ui&&!1!==this.options.uiEnabled){var e={};this.element.setAttribute(this.options.namespace+"id",this.__id__),e.$errorClassHandler=this._manageClassHandler(),e.errorsWrapperId="parsley-id-"+(this.options.multiple?"multiple-"+this.options.multiple:this.__id__),e.$errorsWrapper=t(this.options.errorsWrapper).attr("id",e.errorsWrapperId),e.lastValidationResult=[],e.validationInformationVisible=!1,this._ui=e}},_manageClassHandler:function(){if("string"==typeof this.options.classHandler&&t(this.options.classHandler).length)return t(this.options.classHandler);var e=this.options.classHandler;if("string"==typeof this.options.classHandler&&"function"==typeof window[this.options.classHandler]&&(e=window[this.options.classHandler]),"function"==typeof e){var i=e.call(this,this);if(void 0!==i&&i.length)return i}else{if("object"==typeof e&&e instanceof jQuery&&e.length)return e;e&&o.warn("The class handler `"+e+"` does not exist in DOM nor as a global JS function")}return this._inputHolder()},_inputHolder:function(){return this.options.multiple&&"SELECT"!==this.element.nodeName?this.$element.parent():this.$element},_insertErrorWrapper:function(){var e=this.options.errorsContainer;if(0!==this._ui.$errorsWrapper.parent().length)return this._ui.$errorsWrapper.parent();if("string"==typeof e){if(t(e).length)return t(e).append(this._ui.$errorsWrapper);"function"==typeof window[e]?e=window[e]:o.warn("The errors container `"+e+"` does not exist in DOM nor as a global JS function")}return"function"==typeof e&&(e=e.call(this,this)),"object"==typeof e&&e.length?e.append(this._ui.$errorsWrapper):this._inputHolder().after(this._ui.$errorsWrapper)},_actualizeTriggers:function(){var t,e=this,i=this._findRelated();i.off(".Parsley"),this._failedOnce?i.on(o.namespaceEvents(this.options.triggerAfterFailure,"Parsley"),function(){e._validateIfNeeded()}):(t=o.namespaceEvents(this.options.trigger,"Parsley"))&&i.on(t,function(t){e._validateIfNeeded(t)})},_validateIfNeeded:function(t){var e=this;t&&/key|input/.test(t.type)&&(!this._ui||!this._ui.validationInformationVisible)&&this.getValue().length<=this.options.validationThreshold||(this.options.debounce?(window.clearTimeout(this._debounced),this._debounced=window.setTimeout(function(){return e.validate()},this.options.debounce)):this.validate())},_resetUI:function(){this._failedOnce=!1,this._actualizeTriggers(),void 0!==this._ui&&(this._ui.$errorsWrapper.removeClass("filled").children().remove(),this._resetClass(),this._ui.lastValidationResult=[],this._ui.validationInformationVisible=!1)},_destroyUI:function(){this._resetUI(),void 0!==this._ui&&this._ui.$errorsWrapper.remove(),delete this._ui},_successClass:function(){this._ui.validationInformationVisible=!0,this._ui.$errorClassHandler.removeClass(this.options.errorClass).addClass(this.options.successClass)},_errorClass:function(){this._ui.validationInformationVisible=!0,this._ui.$errorClassHandler.removeClass(this.options.successClass).addClass(this.options.errorClass)},_resetClass:function(){this._ui.$errorClassHandler.removeClass(this.options.successClass).removeClass(this.options.errorClass)}};var _=function(e,i,n){this.__class__="Form",this.element=e,this.$element=t(e),this.domOptions=i,this.options=n,this.parent=window.Parsley,this.fields=[],this.validationResult=null},w={pending:null,resolved:!0,rejected:!1};_.prototype={onSubmitValidate:function(t){var e=this;if(!0!==t.parsley){var i=this._submitSource||this.$element.find(o._SubmitSelector)[0];if(this._submitSource=null,this.$element.find(".parsley-synthetic-submit-button").prop("disabled",!0),!i||null===i.getAttribute("formnovalidate")){window.Parsley._remoteCache={};var n=this.whenValidate({event:t});"resolved"===n.state()&&!1!==this._trigger("submit")||(t.stopImmediatePropagation(),t.preventDefault(),"pending"===n.state()&&n.done(function(){e._submit(i)}))}}},onSubmitButton:function(t){this._submitSource=t.currentTarget},_submit:function(e){if(!1!==this._trigger("submit")){if(e){var i=this.$element.find(".parsley-synthetic-submit-button").prop("disabled",!1);0===i.length&&(i=t('<input class="parsley-synthetic-submit-button" type="hidden">').appendTo(this.$element)),i.attr({name:e.getAttribute("name"),value:e.getAttribute("value")})}this.$element.trigger(_extends(t.Event("submit"),{parsley:!0}))}},validate:function(e){if(arguments.length>=1&&!t.isPlainObject(e)){o.warnOnce("Calling validate on a parsley form without passing arguments as an object is deprecated.");var i=_slice.call(arguments);e={group:i[0],force:i[1],event:i[2]}}return w[this.whenValidate(e).state()]},whenValidate:function(){var e,i=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],s=n.group,r=n.force,a=n.event;this.submitEvent=a,a&&(this.submitEvent=_extends({},a,{preventDefault:function(){o.warnOnce("Using `this.submitEvent.preventDefault()` is deprecated; instead, call `this.validationResult = false`"),i.validationResult=!1}})),this.validationResult=!0,this._trigger("validate"),this._refreshFields();var l=this._withoutReactualizingFormOptions(function(){return t.map(i.fields,function(t){return t.whenValidate({force:r,group:s})})});return(e=o.all(l).done(function(){i._trigger("success")}).fail(function(){i.validationResult=!1,i.focus(),i._trigger("error")}).always(function(){i._trigger("validated")})).pipe.apply(e,_toConsumableArray(this._pipeAccordingToValidationResult()))},isValid:function(e){if(arguments.length>=1&&!t.isPlainObject(e)){o.warnOnce("Calling isValid on a parsley form without passing arguments as an object is deprecated.");var i=_slice.call(arguments);e={group:i[0],force:i[1]}}return w[this.whenValid(e).state()]},whenValid:function(){var e=this,i=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=i.group,s=i.force;this._refreshFields();var r=this._withoutReactualizingFormOptions(function(){return t.map(e.fields,function(t){return t.whenValid({group:n,force:s})})});return o.all(r)},refresh:function(){return this._refreshFields(),this},reset:function(){for(var t=0;t<this.fields.length;t++)this.fields[t].reset();this._trigger("reset")},destroy:function(){this._destroyUI();for(var t=0;t<this.fields.length;t++)this.fields[t].destroy();this.$element.removeData("Parsley"),this._trigger("destroy")},_refreshFields:function(){return this.actualizeOptions()._bindFields()},_bindFields:function(){var e=this,i=this.fields;return this.fields=[],this.fieldsMappedById={},this._withoutReactualizingFormOptions(function(){e.$element.find(e.options.inputs).not(e.options.excluded).each(function(t,i){var n=new window.Parsley.Factory(i,{},e);if(("Field"===n.__class__||"FieldMultiple"===n.__class__)&&!0!==n.options.excluded){var s=n.__class__+"-"+n.__id__;void 0===e.fieldsMappedById[s]&&(e.fieldsMappedById[s]=n,e.fields.push(n))}}),t.each(o.difference(i,e.fields),function(t,e){e.reset()})}),this},_withoutReactualizingFormOptions:function(t){var e=this.actualizeOptions;this.actualizeOptions=function(){return this};var i=t();return this.actualizeOptions=e,i},_trigger:function(t){return this.trigger("form:"+t)}};var C=function(t,e,i,n,s){var r=window.Parsley._validatorRegistry.validators[e],o=new c(r);n=n||t.options[e+"Priority"]||o.priority,s=!0===s,_extends(this,{validator:o,name:e,requirements:i,priority:n,isDomConstraint:s}),this._parseRequirements(t.options)},k=function(t){return t[0].toUpperCase()+t.slice(1)};C.prototype={validate:function(t,e){var i;return(i=this.validator).validate.apply(i,[t].concat(_toConsumableArray(this.requirementList),[e]))},_parseRequirements:function(t){var e=this;this.requirementList=this.validator.parseRequirements(this.requirements,function(i){return t[e.name+k(i)]})}};var A=function(e,i,n,s){this.__class__="Field",this.element=e,this.$element=t(e),void 0!==s&&(this.parent=s),this.options=n,this.domOptions=i,this.constraints=[],this.constraintsByName={},this.validationResult=!0,this._bindConstraints()},E={pending:null,resolved:!0,rejected:!1};A.prototype={validate:function(e){arguments.length>=1&&!t.isPlainObject(e)&&(o.warnOnce("Calling validate on a parsley field without passing arguments as an object is deprecated."),e={options:e});var i=this.whenValidate(e);if(!i)return!0;switch(i.state()){case"pending":return null;case"resolved":return!0;case"rejected":return this.validationResult}},whenValidate:function(){var t,e=this,i=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=i.force,s=i.group;if(this.refresh(),!s||this._isInGroup(s))return this.value=this.getValue(),this._trigger("validate"),(t=this.whenValid({force:n,value:this.value,_refreshed:!0}).always(function(){e._reflowUI()}).done(function(){e._trigger("success")}).fail(function(){e._trigger("error")}).always(function(){e._trigger("validated")})).pipe.apply(t,_toConsumableArray(this._pipeAccordingToValidationResult()))},hasConstraints:function(){return 0!==this.constraints.length},needsValidation:function(t){return void 0===t&&(t=this.getValue()),!(!t.length&&!this._isRequired()&&void 0===this.options.validateIfEmpty)},_isInGroup:function(e){return Array.isArray(this.options.group)?-1!==t.inArray(e,this.options.group):this.options.group===e},isValid:function(e){if(arguments.length>=1&&!t.isPlainObject(e)){o.warnOnce("Calling isValid on a parsley field without passing arguments as an object is deprecated.");var i=_slice.call(arguments);e={force:i[0],value:i[1]}}var n=this.whenValid(e);return!n||E[n.state()]},whenValid:function(){var e=this,i=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=i.force,s=void 0!==n&&n,r=i.value,a=i.group;if(i._refreshed||this.refresh(),!a||this._isInGroup(a)){if(this.validationResult=!0,!this.hasConstraints())return t.when();if(void 0!==r&&null!==r||(r=this.getValue()),!this.needsValidation(r)&&!0!==s)return t.when();var l=this._getGroupedConstraints(),u=[];return t.each(l,function(i,n){var s=o.all(t.map(n,function(t){return e._validateConstraint(r,t)}));if(u.push(s),"rejected"===s.state())return!1}),o.all(u)}},_validateConstraint:function(e,i){var n=this,s=i.validate(e,this);return!1===s&&(s=t.Deferred().reject()),o.all([s]).fail(function(t){n.validationResult instanceof Array||(n.validationResult=[]),n.validationResult.push({assert:i,errorMessage:"string"==typeof t&&t})})},getValue:function(){var t;return t="function"==typeof this.options.value?this.options.value(this):void 0!==this.options.value?this.options.value:this.$element.val(),void 0===t||null===t?"":this._handleWhitespace(t)},reset:function(){return this._resetUI(),this._trigger("reset")},destroy:function(){this._destroyUI(),this.$element.removeData("Parsley"),this.$element.removeData("FieldMultiple"),this._trigger("destroy")},refresh:function(){return this._refreshConstraints(),this},_refreshConstraints:function(){return this.actualizeOptions()._bindConstraints()},refreshConstraints:function(){return o.warnOnce("Parsley's refreshConstraints is deprecated. Please use refresh"),this.refresh()},addConstraint:function(t,e,i,n){if(window.Parsley._validatorRegistry.validators[t]){var s=new C(this,t,e,i,n);"undefined"!==this.constraintsByName[s.name]&&this.removeConstraint(s.name),this.constraints.push(s),this.constraintsByName[s.name]=s}return this},removeConstraint:function(t){for(var e=0;e<this.constraints.length;e++)if(t===this.constraints[e].name){this.constraints.splice(e,1);break}return delete this.constraintsByName[t],this},updateConstraint:function(t,e,i){return this.removeConstraint(t).addConstraint(t,e,i)},_bindConstraints:function(){for(var t=[],e={},i=0;i<this.constraints.length;i++)!1===this.constraints[i].isDomConstraint&&(t.push(this.constraints[i]),e[this.constraints[i].name]=this.constraints[i]);this.constraints=t,this.constraintsByName=e;for(var n in this.options)this.addConstraint(n,this.options[n],void 0,!0);return this._bindHtml5Constraints()},_bindHtml5Constraints:function(){null!==this.element.getAttribute("required")&&this.addConstraint("required",!0,void 0,!0),null!==this.element.getAttribute("pattern")&&this.addConstraint("pattern",this.element.getAttribute("pattern"),void 0,!0);var t=this.element.getAttribute("min"),e=this.element.getAttribute("max");null!==t&&null!==e?this.addConstraint("range",[t,e],void 0,!0):null!==t?this.addConstraint("min",t,void 0,!0):null!==e&&this.addConstraint("max",e,void 0,!0),null!==this.element.getAttribute("minlength")&&null!==this.element.getAttribute("maxlength")?this.addConstraint("length",[this.element.getAttribute("minlength"),this.element.getAttribute("maxlength")],void 0,!0):null!==this.element.getAttribute("minlength")?this.addConstraint("minlength",this.element.getAttribute("minlength"),void 0,!0):null!==this.element.getAttribute("maxlength")&&this.addConstraint("maxlength",this.element.getAttribute("maxlength"),void 0,!0);var i=o.getType(this.element);return"number"===i?this.addConstraint("type",["number",{step:this.element.getAttribute("step")||"1",base:t||this.element.getAttribute("value")}],void 0,!0):/^(email|url|range|date)$/i.test(i)?this.addConstraint("type",i,void 0,!0):this},_isRequired:function(){return void 0!==this.constraintsByName.required&&!1!==this.constraintsByName.required.requirements},_trigger:function(t){return this.trigger("field:"+t)},_handleWhitespace:function(t){return!0===this.options.trimValue&&o.warnOnce('data-parsley-trim-value="true" is deprecated, please use data-parsley-whitespace="trim"'),"squish"===this.options.whitespace&&(t=t.replace(/\s{2,}/g," ")),"trim"!==this.options.whitespace&&"squish"!==this.options.whitespace&&!0!==this.options.trimValue||(t=o.trimString(t)),t},_isDateInput:function(){var t=this.constraintsByName.type;return t&&"date"===t.requirements},_getGroupedConstraints:function(){if(!1===this.options.priorityEnabled)return[this.constraints];for(var t=[],e={},i=0;i<this.constraints.length;i++){var n=this.constraints[i].priority;e[n]||t.push(e[n]=[]),e[n].push(this.constraints[i])}return t.sort(function(t,e){return e[0].priority-t[0].priority}),t}};var x=A,S=function(){this.__class__="FieldMultiple"};S.prototype={addElement:function(t){return this.$elements.push(t),this},_refreshConstraints:function(){var e;if(this.constraints=[],"SELECT"===this.element.nodeName)return this.actualizeOptions()._bindConstraints(),this;for(var i=0;i<this.$elements.length;i++)if(t("html").has(this.$elements[i]).length){e=this.$elements[i].data("FieldMultiple")._refreshConstraints().constraints;for(var n=0;n<e.length;n++)this.addConstraint(e[n].name,e[n].requirements,e[n].priority,e[n].isDomConstraint)}else this.$elements.splice(i,1);return this},getValue:function(){if("function"==typeof this.options.value)return this.options.value(this);if(void 0!==this.options.value)return this.options.value;if("INPUT"===this.element.nodeName){var e=o.getType(this.element);if("radio"===e)return this._findRelated().filter(":checked").val()||"";if("checkbox"===e){var i=[];return this._findRelated().filter(":checked").each(function(){i.push(t(this).val())}),i}}return"SELECT"===this.element.nodeName&&null===this.$element.val()?[]:this.$element.val()},_init:function(){return this.$elements=[this.$element],this}};var F=function(e,i,n){this.element=e,this.$element=t(e);var s=this.$element.data("Parsley");if(s)return void 0!==n&&s.parent===window.Parsley&&(s.parent=n,s._resetOptions(s.options)),"object"==typeof i&&_extends(s.options,i),s;if(!this.$element.length)throw new Error("You must bind Parsley on an existing element.");if(void 0!==n&&"Form"!==n.__class__)throw new Error("Parent instance must be a Form instance");return this.parent=n||window.Parsley,this.init(i)};F.prototype={init:function(t){return this.__class__="Parsley",this.__version__="2.8.0",this.__id__=o.generateID(),this._resetOptions(t),"FORM"===this.element.nodeName||o.checkAttr(this.element,this.options.namespace,"validate")&&!this.$element.is(this.options.inputs)?this.bind("parsleyForm"):this.isMultiple()?this.handleMultiple():this.bind("parsleyField")},isMultiple:function(){var t=o.getType(this.element);return"radio"===t||"checkbox"===t||"SELECT"===this.element.nodeName&&null!==this.element.getAttribute("multiple")},handleMultiple:function(){var e,i,n=this;if(this.options.multiple=this.options.multiple||(e=this.element.getAttribute("name"))||this.element.getAttribute("id"),"SELECT"===this.element.nodeName&&null!==this.element.getAttribute("multiple"))return this.options.multiple=this.options.multiple||this.__id__,this.bind("parsleyFieldMultiple");if(!this.options.multiple)return o.warn("To be bound by Parsley, a radio, a checkbox and a multiple select input must have either a name or a multiple option.",this.$element),this;this.options.multiple=this.options.multiple.replace(/(:|\.|\[|\]|\{|\}|\$)/g,""),e&&t('input[name="'+e+'"]').each(function(t,e){var i=o.getType(e);"radio"!==i&&"checkbox"!==i||e.setAttribute(n.options.namespace+"multiple",n.options.multiple)});for(var s=this._findRelated(),r=0;r<s.length;r++)if(void 0!==(i=t(s.get(r)).data("Parsley"))){this.$element.data("FieldMultiple")||i.addElement(this.$element);break}return this.bind("parsleyField",!0),i||this.bind("parsleyFieldMultiple")},bind:function(e,i){var n;switch(e){case"parsleyForm":n=t.extend(new _(this.element,this.domOptions,this.options),new l,window.ParsleyExtend)._bindFields();break;case"parsleyField":n=t.extend(new x(this.element,this.domOptions,this.options,this.parent),new l,window.ParsleyExtend);break;case"parsleyFieldMultiple":n=t.extend(new x(this.element,this.domOptions,this.options,this.parent),new S,new l,window.ParsleyExtend)._init();break;default:throw new Error(e+"is not a supported Parsley type")}return this.options.multiple&&o.setAttr(this.element,this.options.namespace,"multiple",this.options.multiple),void 0!==i?(this.$element.data("FieldMultiple",n),n):(this.$element.data("Parsley",n),n._actualizeTriggers(),n._trigger("init"),n)}};var O=t.fn.jquery.split(".");if(parseInt(O[0])<=1&&parseInt(O[1])<8)throw"The loaded version of jQuery is too old. Please upgrade to 1.8.x or better.";O.forEach||o.warn("Parsley requires ES5 to run properly. Please include https://github.com/es-shims/es5-shim");var T=_extends(new l,{element:document,$element:t(document),actualizeOptions:null,_resetOptions:null,Factory:F,version:"2.8.0"});_extends(x.prototype,v.Field,l.prototype),_extends(_.prototype,v.Form,l.prototype),_extends(F.prototype,l.prototype),t.fn.parsley=t.fn.psly=function(e){if(this.length>1){var i=[];return this.each(function(){i.push(t(this).parsley(e))}),i}if(0!=this.length)return new F(this[0],e)},void 0===window.ParsleyExtend&&(window.ParsleyExtend={}),T.options=_extends(o.objectCreate(a),window.ParsleyConfig),window.ParsleyConfig=T.options,window.Parsley=window.psly=T,T.Utils=o,window.ParsleyUtils={},t.each(o,function(t,e){"function"==typeof e&&(window.ParsleyUtils[t]=function(){return o.warnOnce("Accessing `window.ParsleyUtils` is deprecated. Use `window.Parsley.Utils` instead."),o[t].apply(o,arguments)})});var I=window.Parsley._validatorRegistry=new d(window.ParsleyConfig.validators,window.ParsleyConfig.i18n);window.ParsleyValidator={},t.each("setLocale addCatalog addMessage addMessages getErrorMessage formatMessage addValidator updateValidator removeValidator hasValidator".split(" "),function(t,e){window.Parsley[e]=function(){return I[e].apply(I,arguments)},window.ParsleyValidator[e]=function(){var t;return o.warnOnce("Accessing the method '"+e+"' through Validator is deprecated. Simply call 'window.Parsley."+e+"(...)'"),(t=window.Parsley)[e].apply(t,arguments)}}),window.Parsley.UI=v,window.ParsleyUI={removeError:function(t,e,i){var n=!0!==i;return o.warnOnce("Accessing UI is deprecated. Call 'removeError' on the instance directly. Please comment in issue 1073 as to your need to call this method."),t.removeError(e,{updateClass:n})},getErrorsMessages:function(t){return o.warnOnce("Accessing UI is deprecated. Call 'getErrorsMessages' on the instance directly."),t.getErrorsMessages()}},t.each("addError updateError".split(" "),function(t,e){window.ParsleyUI[e]=function(t,i,n,s,r){var a=!0!==r;return o.warnOnce("Accessing UI is deprecated. Call '"+e+"' on the instance directly. Please comment in issue 1073 as to your need to call this method."),t[e](i,{message:n,assert:s,updateClass:a})}}),!1!==window.ParsleyConfig.autoBind&&t(function(){t("[data-parsley-validate]").length&&t("[data-parsley-validate]").parsley()});var $=t({}),D=function(){o.warnOnce("Parsley's pubsub module is deprecated; use the 'on' and 'off' methods on parsley instances or window.Parsley")},q="parsley:";t.listen=function(t,n){var s;if(D(),"object"==typeof arguments[1]&&"function"==typeof arguments[2]&&(s=arguments[1],n=arguments[2]),"function"!=typeof n)throw new Error("Wrong parameters");window.Parsley.on(i(t),e(n,s))},t.listenTo=function(t,n,s){if(D(),!(t instanceof x||t instanceof _))throw new Error("Must give Parsley instance");if("string"!=typeof n||"function"!=typeof s)throw new Error("Wrong parameters");t.on(i(n),e(s))},t.unsubscribe=function(t,e){if(D(),"string"!=typeof t||"function"!=typeof e)throw new Error("Wrong arguments");window.Parsley.off(i(t),e.parsleyAdaptedCallback)},t.unsubscribeTo=function(t,e){if(D(),!(t instanceof x||t instanceof _))throw new Error("Must give Parsley instance");t.off(i(e))},t.unsubscribeAll=function(e){D(),window.Parsley.off(i(e)),t("form,input,textarea,select").each(function(){var n=t(this).data("Parsley");n&&n.off(i(e))})},t.emit=function(t,e){var n;D();var s=e instanceof x||e instanceof _,r=Array.prototype.slice.call(arguments,s?2:1);r.unshift(i(t)),s||(e=window.Parsley),(n=e).trigger.apply(n,_toConsumableArray(r))};return t.extend(!0,T,{asyncValidators:{default:{fn:function(t){return t.status>=200&&t.status<300},url:!1},reverse:{fn:function(t){return t.status<200||t.status>=300},url:!1}},addAsyncValidator:function(t,e,i,n){return T.asyncValidators[t]={fn:e,url:i||!1,options:n||{}},this}}),T.addValidator("remote",{requirementType:{"":"string",validator:"string",reverse:"boolean",options:"object"},validateString:function(e,i,n,s){var r,o,a={},l=n.validator||(!0===n.reverse?"reverse":"default");if(void 0===T.asyncValidators[l])throw new Error("Calling an undefined async validator: `"+l+"`");i=T.asyncValidators[l].url||i,i.indexOf("{value}")>-1?i=i.replace("{value}",encodeURIComponent(e)):a[s.element.getAttribute("name")||s.element.getAttribute("id")]=e;var u=t.extend(!0,n.options||{},T.asyncValidators[l].options);r=t.extend(!0,{},{url:i,data:a,type:"GET"},u),s.trigger("field:ajaxoptions",s,r),o=t.param(r),void 0===T._remoteCache&&(T._remoteCache={});var h=T._remoteCache[o]=T._remoteCache[o]||t.ajax(r),c=function(){var e=T.asyncValidators[l].fn.call(s,h,i,n);return e||(e=t.Deferred().reject()),t.when(e)};return h.then(c,c)},priority:-1}),T.on("form:submit",function(){T._remoteCache={}}),l.prototype.addAsyncValidator=function(){return o.warnOnce("Accessing the method `addAsyncValidator` through an instance is deprecated. Simply call `Parsley.addAsyncValidator(...)`"),T.addAsyncValidator.apply(T,arguments)},T.addMessages("en",{defaultMessage:"This value seems to be invalid.",type:{email:"This value should be a valid email.",url:"This value should be a valid url.",number:"This value should be a valid number.",integer:"This value should be a valid integer.",digits:"This value should be digits.",alphanum:"This value should be alphanumeric."},notblank:"This value should not be blank.",required:"This value is required.",pattern:"This value seems to be invalid.",min:"This value should be greater than or equal to %s.",max:"This value should be lower than or equal to %s.",range:"This value should be between %s and %s.",minlength:"This value is too short. It should have %s characters or more.",maxlength:"This value is too long. It should have %s characters or fewer.",length:"This value length is invalid. It should be between %s and %s characters long.",mincheck:"You must select at least %s choices.",maxcheck:"You must select %s choices or fewer.",check:"You must select between %s and %s choices.",equalto:"This value should be the same."}),T.setLocale("en"),(new n).install(),T}),function(t){"function"==typeof define&&define.amd?define("jquery-typeahead",["jquery"],function(e){return t(e)}):"object"==typeof module&&module.exports?module.exports=function(e,i){return void 0===e&&(e="undefined"!=typeof window?require("jquery"):require("jquery")(void 0)),t(e)}():t(jQuery)}(function(t){"use strict";window.Typeahead={version:"2.10.4"};var e={input:null,minLength:2,maxLength:!1,maxItem:8,dynamic:!1,delay:300,order:null,offset:!1,hint:!1,accent:!1,highlight:!0,multiselect:null,group:!1,groupOrder:null,maxItemPerGroup:null,dropdownFilter:!1,dynamicFilter:null,backdrop:!1,backdropOnFocus:!1,cache:!1,ttl:36e5,compression:!1,searchOnFocus:!1,blurOnTab:!0,resultContainer:null,generateOnLoad:null,mustSelectItem:!1,href:null,display:["display"],template:null,templateValue:null,groupTemplate:null,correlativeTemplate:!1,emptyTemplate:!1,cancelButton:!0,loadingAnimation:!0,filter:!0,matcher:null,source:null,callback:{onInit:null,onReady:null,onShowLayout:null,onHideLayout:null,onSearch:null,onResult:null,onLayoutBuiltBefore:null,onLayoutBuiltAfter:null,onNavigateBefore:null,onNavigateAfter:null,onEnter:null,onLeave:null,onClickBefore:null,onClickAfter:null,onDropdownFilter:null,onSendRequest:null,onReceiveRequest:null,onPopulateSource:null,onCacheSave:null,onSubmit:null,onCancel:null},selector:{container:"typeahead__container",result:"typeahead__result",list:"typeahead__list",group:"typeahead__group",item:"typeahead__item",empty:"typeahead__empty",display:"typeahead__display",query:"typeahead__query",filter:"typeahead__filter",filterButton:"typeahead__filter-button",dropdown:"typeahead__dropdown",dropdownItem:"typeahead__dropdown-item",labelContainer:"typeahead__label-container",label:"typeahead__label",button:"typeahead__button",backdrop:"typeahead__backdrop",hint:"typeahead__hint",cancelButton:"typeahead__cancel-button"},debug:!1},i={from:"",to:"aaaaaeeeeeiiiiooooouuuunc"},n=~window.navigator.appVersion.indexOf("MSIE 9."),s=~window.navigator.appVersion.indexOf("MSIE 10"),r=!!~window.navigator.userAgent.indexOf("Trident")&&~window.navigator.userAgent.indexOf("rv:11"),o=function(t,e){this.rawQuery=t.val()||"",this.query=t.val()||"",this.selector=t[0].selector,this.deferred=null,this.tmpSource={},this.source={},this.dynamicGroups=[],this.hasDynamicGroups=!1,this.generatedGroupCount=0,this.groupBy="group",this.groups=[],this.searchGroups=[],this.generateGroups=[],this.requestGroups=[],this.result=[],this.tmpResult={},this.groupTemplate="",this.resultHtml=null,this.resultCount=0,this.resultCountPerGroup={},this.options=e,this.node=t,this.namespace="."+this.helper.slugify.call(this,this.selector)+".typeahead",this.isContentEditable=void 0!==this.node.attr("contenteditable")&&"false"!==this.node.attr("contenteditable"),this.container=null,this.resultContainer=null,this.item=null,this.items=null,this.comparedItems=null,this.xhr={},this.hintIndex=null,this.filters={dropdown:{},dynamic:{}},this.dropdownFilter={static:[],dynamic:[]},this.dropdownFilterAll=null,this.isDropdownEvent=!1,this.requests={},this.backdrop={},this.hint={},this.label={},this.hasDragged=!1,this.focusOnly=!1,this.__construct()};o.prototype={_validateCacheMethod:function(t){var e,i=["localStorage","sessionStorage"];if(!0===t)t="localStorage";else if("string"==typeof t&&!~i.indexOf(t))return!1;e=void 0!==window[t];try{window[t].setItem("typeahead","typeahead"),window[t].removeItem("typeahead")}catch(t){e=!1}return e&&t||!1},extendOptions:function(){if(this.options.cache=this._validateCacheMethod(this.options.cache),this.options.compression&&("object"==typeof LZString&&this.options.cache||(this.options.compression=!1)),(!this.options.maxLength||isNaN(this.options.maxLength))&&(this.options.maxLength=1/0),void 0!==this.options.maxItem&&~[0,!1].indexOf(this.options.maxItem)&&(this.options.maxItem=1/0),this.options.maxItemPerGroup&&!/^\d+$/.test(this.options.maxItemPerGroup)&&(this.options.maxItemPerGroup=null),this.options.display&&!Array.isArray(this.options.display)&&(this.options.display=[this.options.display]),this.options.multiselect&&(this.items=[],this.comparedItems=[],"string"==typeof this.options.multiselect.matchOn&&(this.options.multiselect.matchOn=[this.options.multiselect.matchOn])),this.options.group&&(Array.isArray(this.options.group)||("string"==typeof this.options.group?this.options.group={key:this.options.group}:"boolean"==typeof this.options.group&&(this.options.group={key:"group"}),this.options.group.key=this.options.group.key||"group")),this.options.highlight&&!~["any",!0].indexOf(this.options.highlight)&&(this.options.highlight=!1),this.options.dropdownFilter&&this.options.dropdownFilter instanceof Object){Array.isArray(this.options.dropdownFilter)||(this.options.dropdownFilter=[this.options.dropdownFilter]);for(var n=0,s=this.options.dropdownFilter.length;s>n;++n)this.dropdownFilter[this.options.dropdownFilter[n].value?"static":"dynamic"].push(this.options.dropdownFilter[n])}this.options.dynamicFilter&&!Array.isArray(this.options.dynamicFilter)&&(this.options.dynamicFilter=[this.options.dynamicFilter]),this.options.accent&&("object"==typeof this.options.accent?this.options.accent.from&&this.options.accent.to&&(this.options.accent.from.length,this.options.accent.to.length):this.options.accent=i),this.options.groupTemplate&&(this.groupTemplate=this.options.groupTemplate),this.options.resultContainer&&("string"==typeof this.options.resultContainer&&(this.options.resultContainer=t(this.options.resultContainer)),this.options.resultContainer instanceof t&&this.options.resultContainer[0]&&(this.resultContainer=this.options.resultContainer)),this.options.maxItemPerGroup&&this.options.group&&this.options.group.key&&(this.groupBy=this.options.group.key),this.options.callback&&this.options.callback.onClick&&(this.options.callback.onClickBefore=this.options.callback.onClick,delete this.options.callback.onClick),this.options.callback&&this.options.callback.onNavigate&&(this.options.callback.onNavigateBefore=this.options.callback.onNavigate,delete this.options.callback.onNavigate),this.options=t.extend(!0,{},e,this.options)},unifySourceFormat:function(){
this.dynamicGroups=[],Array.isArray(this.options.source)&&(this.options.source={group:{data:this.options.source}}),"string"==typeof this.options.source&&(this.options.source={group:{ajax:{url:this.options.source}}}),this.options.source.ajax&&(this.options.source={group:{ajax:this.options.source.ajax}}),(this.options.source.url||this.options.source.data)&&(this.options.source={group:this.options.source});var t,e,i;for(t in this.options.source)if(this.options.source.hasOwnProperty(t)){if(e=this.options.source[t],"string"==typeof e&&(e={ajax:{url:e}}),i=e.url||e.ajax,Array.isArray(i)?(e.ajax="string"==typeof i[0]?{url:i[0]}:i[0],e.ajax.path=e.ajax.path||i[1]||null,delete e.url):("object"==typeof e.url?e.ajax=e.url:"string"==typeof e.url&&(e.ajax={url:e.url}),delete e.url),!e.data&&!e.ajax)return!1;e.display&&!Array.isArray(e.display)&&(e.display=[e.display]),e.minLength="number"==typeof e.minLength?e.minLength:this.options.minLength,e.maxLength="number"==typeof e.maxLength?e.maxLength:this.options.maxLength,e.dynamic="boolean"==typeof e.dynamic||this.options.dynamic,e.minLength>e.maxLength&&(e.minLength=e.maxLength),this.options.source[t]=e,this.options.source[t].dynamic&&this.dynamicGroups.push(t),e.cache=void 0!==e.cache?this._validateCacheMethod(e.cache):this.options.cache,e.compression&&("object"==typeof LZString&&e.cache||(e.compression=!1))}return this.hasDynamicGroups=this.options.dynamic||!!this.dynamicGroups.length,!0},init:function(){this.helper.executeCallback.call(this,this.options.callback.onInit,[this.node]),this.container=this.node.closest("."+this.options.selector.container)},delegateEvents:function(){var e=this,i=["focus"+this.namespace,"input"+this.namespace,"propertychange"+this.namespace,"keydown"+this.namespace,"keyup"+this.namespace,"search"+this.namespace,"generate"+this.namespace];t("html").on("touchmove",function(){e.hasDragged=!0}).on("touchstart",function(){e.hasDragged=!1}),this.node.closest("form").on("submit",function(t){return e.options.mustSelectItem&&e.helper.isEmpty(e.item)?void t.preventDefault():(e.options.backdropOnFocus||e.hideLayout(),e.options.callback.onSubmit?e.helper.executeCallback.call(e,e.options.callback.onSubmit,[e.node,this,e.item||e.items,t]):void 0)}).on("reset",function(){setTimeout(function(){e.node.trigger("input"+e.namespace),e.hideLayout()})});var o=!1;if(this.node.attr("placeholder")&&(s||r)){var a=!0;this.node.on("focusin focusout",function(){a=!(this.value||!this.placeholder)}),this.node.on("input",function(t){a&&(t.stopImmediatePropagation(),a=!1)})}this.node.off(this.namespace).on(i.join(" "),function(i,s){switch(i.type){case"generate":e.generateSource(Object.keys(e.options.source));break;case"focus":if(e.focusOnly){e.focusOnly=!1;break}e.options.backdropOnFocus&&(e.buildBackdropLayout(),e.showLayout()),e.options.searchOnFocus&&!e.item&&(e.deferred=t.Deferred(),e.assignQuery(),e.generateSource());break;case"keydown":8===i.keyCode&&e.options.multiselect&&e.options.multiselect.cancelOnBackspace&&""===e.query&&e.items.length?e.cancelMultiselectItem(e.items.length-1,null,i):i.keyCode&&~[9,13,27,38,39,40].indexOf(i.keyCode)&&(o=!0,e.navigate(i));break;case"keyup":n&&e.node[0].value.replace(/^\s+/,"").toString().length<e.query.length&&e.node.trigger("input"+e.namespace);break;case"propertychange":if(o){o=!1;break}case"input":e.deferred=t.Deferred(),e.assignQuery(),""===e.rawQuery&&""===e.query&&(i.originalEvent=s||{},e.helper.executeCallback.call(e,e.options.callback.onCancel,[e.node,i])),e.options.cancelButton&&e.toggleCancelButtonVisibility(),e.options.hint&&e.hint.container&&""!==e.hint.container.val()&&0!==e.hint.container.val().indexOf(e.rawQuery)&&(e.hint.container.val(""),e.isContentEditable&&e.hint.container.text("")),e.hasDynamicGroups?e.helper.typeWatch(function(){e.generateSource()},e.options.delay):e.generateSource();break;case"search":e.searchResult(),e.buildLayout(),e.result.length||e.searchGroups.length&&e.options.emptyTemplate&&e.query.length?e.showLayout():e.hideLayout(),e.deferred&&e.deferred.resolve()}return e.deferred&&e.deferred.promise()}),this.options.generateOnLoad&&this.node.trigger("generate"+this.namespace)},assignQuery:function(){this.isContentEditable?this.rawQuery=this.node.text():this.rawQuery=this.node.val().toString(),this.rawQuery=this.rawQuery.replace(/^\s+/,""),this.rawQuery!==this.query&&(this.item=null,this.query=this.rawQuery)},filterGenerateSource:function(){if(this.searchGroups=[],this.generateGroups=[],!this.focusOnly||this.options.multiselect)for(var t in this.options.source)if(this.options.source.hasOwnProperty(t)&&this.query.length>=this.options.source[t].minLength&&this.query.length<=this.options.source[t].maxLength){if(this.searchGroups.push(t),!this.options.source[t].dynamic&&this.source[t])continue;this.generateGroups.push(t)}},generateSource:function(e){if(this.filterGenerateSource(),Array.isArray(e)&&e.length)this.generateGroups=e;else if(!this.generateGroups.length)return void this.node.trigger("search"+this.namespace);if(this.requestGroups=[],this.generatedGroupCount=0,this.options.loadingAnimation&&this.container.addClass("loading"),!this.helper.isEmpty(this.xhr)){for(var i in this.xhr)this.xhr.hasOwnProperty(i)&&this.xhr[i].abort();this.xhr={}}for(var n,s,r,o,a,l,u,h=this,i=0,c=this.generateGroups.length;c>i;++i){if(n=this.generateGroups[i],r=this.options.source[n],o=r.cache,a=r.compression,o&&(l=window[o].getItem("TYPEAHEAD_"+this.selector+":"+n))){a&&(l=LZString.decompressFromUTF16(l)),u=!1;try{l=JSON.parse(l+""),l.data&&l.ttl>(new Date).getTime()?(this.populateSource(l.data,n),u=!0):window[o].removeItem("TYPEAHEAD_"+this.selector+":"+n)}catch(t){}if(u)continue}!r.data||r.ajax?r.ajax&&(this.requests[n]||(this.requests[n]=this.generateRequestObject(n)),this.requestGroups.push(n)):"function"==typeof r.data?(s=r.data.call(this),Array.isArray(s)?h.populateSource(s,n):"function"==typeof s.promise&&function(e){t.when(s).then(function(t){t&&Array.isArray(t)&&h.populateSource(t,e)})}(n)):this.populateSource(t.extend(!0,[],r.data),n)}return this.requestGroups.length&&this.handleRequests(),!!this.generateGroups.length},generateRequestObject:function(t){var e=this,i=this.options.source[t],n={request:{url:i.ajax.url||null,dataType:"json",beforeSend:function(n,s){e.xhr[t]=n;var r=e.requests[t].callback.beforeSend||i.ajax.beforeSend;"function"==typeof r&&r.apply(null,arguments)}},callback:{beforeSend:null,done:null,fail:null,then:null,always:null},extra:{path:i.ajax.path||null,group:t},validForGroup:[t]};if("function"!=typeof i.ajax&&(i.ajax instanceof Object&&(n=this.extendXhrObject(n,i.ajax)),Object.keys(this.options.source).length>1))for(var s in this.requests)this.requests.hasOwnProperty(s)&&(this.requests[s].isDuplicated||n.request.url&&n.request.url===this.requests[s].request.url&&(this.requests[s].validForGroup.push(t),n.isDuplicated=!0,delete n.validForGroup));return n},extendXhrObject:function(e,i){return"object"==typeof i.callback&&(e.callback=i.callback,delete i.callback),"function"==typeof i.beforeSend&&(e.callback.beforeSend=i.beforeSend,delete i.beforeSend),e.request=t.extend(!0,e.request,i),"jsonp"!==e.request.dataType.toLowerCase()||e.request.jsonpCallback||(e.request.jsonpCallback="callback_"+e.extra.group),e},handleRequests:function(){var e,i=this,n=this.requestGroups.length;if(!1!==this.helper.executeCallback.call(this,this.options.callback.onSendRequest,[this.node,this.query]))for(var s=0,r=this.requestGroups.length;r>s;++s)e=this.requestGroups[s],this.requests[e].isDuplicated||function(e,s){if("function"==typeof i.options.source[e].ajax){var r=i.options.source[e].ajax.call(i,i.query);if(s=i.extendXhrObject(i.generateRequestObject(e),"object"==typeof r?r:{}),"object"!=typeof s.request||!s.request.url)return void i.populateSource([],e);i.requests[e]=s}var o,a=!1,l={};if(~s.request.url.indexOf("{{query}}")&&(a||(s=t.extend(!0,{},s),a=!0),s.request.url=s.request.url.replace("{{query}}",encodeURIComponent(i.query))),s.request.data)for(var u in s.request.data)if(s.request.data.hasOwnProperty(u)&&~String(s.request.data[u]).indexOf("{{query}}")){a||(s=t.extend(!0,{},s),a=!0),s.request.data[u]=s.request.data[u].replace("{{query}}",i.query);break}t.ajax(s.request).done(function(t,e,n){for(var r,a=0,u=s.validForGroup.length;u>a;a++)r=s.validForGroup[a],o=i.requests[r],o.callback.done instanceof Function&&(l[r]=o.callback.done.call(i,t,e,n))}).fail(function(t,e,n){for(var r=0,a=s.validForGroup.length;a>r;r++)o=i.requests[s.validForGroup[r]],o.callback.fail instanceof Function&&o.callback.fail.call(i,t,e,n)}).always(function(t,e,r){for(var a,u=0,h=s.validForGroup.length;h>u;u++){if(a=s.validForGroup[u],o=i.requests[a],o.callback.always instanceof Function&&o.callback.always.call(i,t,e,r),"object"!=typeof r)return;i.populateSource(null!==t&&"function"==typeof t.promise&&[]||l[a]||t,o.extra.group,o.extra.path||o.request.path),0===(n-=1)&&i.helper.executeCallback.call(i,i.options.callback.onReceiveRequest,[i.node,i.query])}}).then(function(t,e){for(var n=0,r=s.validForGroup.length;r>n;n++)o=i.requests[s.validForGroup[n]],o.callback.then instanceof Function&&o.callback.then.call(i,t,e)})}(e,this.requests[e])},populateSource:function(e,i,n){var s=this,r=this.options.source[i],o=r.ajax&&r.data;n&&"string"==typeof n&&(e=this.helper.namespace.call(this,n,e)),Array.isArray(e)||(e=[]),o&&("function"==typeof o&&(o=o()),Array.isArray(o)&&(e=e.concat(o)));for(var a,l=r.display?"compiled"===r.display[0]?r.display[1]:r.display[0]:"compiled"===this.options.display[0]?this.options.display[1]:this.options.display[0],u=0,h=e.length;h>u;u++)null!==e[u]&&"boolean"!=typeof e[u]&&("string"==typeof e[u]&&(a={},a[l]=e[u],e[u]=a),e[u].group=i);if(!this.hasDynamicGroups&&this.dropdownFilter.dynamic.length)for(var c,d,p={},u=0,h=e.length;h>u;u++)for(var f=0,g=this.dropdownFilter.dynamic.length;g>f;f++)c=this.dropdownFilter.dynamic[f].key,(d=e[u][c])&&(this.dropdownFilter.dynamic[f].value||(this.dropdownFilter.dynamic[f].value=[]),p[c]||(p[c]=[]),~p[c].indexOf(d.toLowerCase())||(p[c].push(d.toLowerCase()),this.dropdownFilter.dynamic[f].value.push(d)));if(this.options.correlativeTemplate){var m=r.template||this.options.template,y="";if("function"==typeof m&&(m=m.call(this,"",{})),m){if(Array.isArray(this.options.correlativeTemplate))for(var u=0,h=this.options.correlativeTemplate.length;h>u;u++)y+="{{"+this.options.correlativeTemplate[u]+"}} ";else y=m.replace(/<.+?>/g," ").replace(/\s{2,}/," ").trim();for(var u=0,h=e.length;h>u;u++)e[u].compiled=t("<textarea />").html(y.replace(/\{\{([\w\-\.]+)(?:\|(\w+))?}}/g,function(t,i){return s.helper.namespace.call(s,i,e[u],"get","")}).trim()).text();r.display?~r.display.indexOf("compiled")||r.display.unshift("compiled"):~this.options.display.indexOf("compiled")||this.options.display.unshift("compiled")}}this.options.callback.onPopulateSource&&(e=this.helper.executeCallback.call(this,this.options.callback.onPopulateSource,[this.node,e,i,n])),this.tmpSource[i]=Array.isArray(e)&&e||[];var v=this.options.source[i].cache,b=this.options.source[i].compression,_=this.options.source[i].ttl||this.options.ttl;if(v&&!window[v].getItem("TYPEAHEAD_"+this.selector+":"+i)){this.options.callback.onCacheSave&&(e=this.helper.executeCallback.call(this,this.options.callback.onCacheSave,[this.node,e,i,n]));var w=JSON.stringify({data:e,ttl:(new Date).getTime()+_});b&&(w=LZString.compressToUTF16(w)),window[v].setItem("TYPEAHEAD_"+this.selector+":"+i,w)}this.incrementGeneratedGroup()},incrementGeneratedGroup:function(){if(++this.generatedGroupCount===this.generateGroups.length){this.xhr={};for(var t=0,e=this.generateGroups.length;e>t;t++)this.source[this.generateGroups[t]]=this.tmpSource[this.generateGroups[t]];this.hasDynamicGroups||this.buildDropdownItemLayout("dynamic"),this.options.loadingAnimation&&this.container.removeClass("loading"),this.node.trigger("search"+this.namespace)}},navigate:function(t){if(this.helper.executeCallback.call(this,this.options.callback.onNavigateBefore,[this.node,this.query,t]),27===t.keyCode)return t.preventDefault(),void(this.query.length?(this.resetInput(),this.node.trigger("input"+this.namespace,[t])):(this.node.blur(),this.hideLayout()));if(this.result.length){var e=this.resultContainer.find("."+this.options.selector.item).not("[disabled]"),i=e.filter(".active"),n=i[0]?e.index(i):null,s=i[0]?i.attr("data-index"):null,r=null,o=null;if(this.clearActiveItem(),this.helper.executeCallback.call(this,this.options.callback.onLeave,[this.node,null!==n&&e.eq(n)||void 0,null!==s&&this.result[s]||void 0,t]),13===t.keyCode)return t.preventDefault(),void(i.length>0?"javascript:;"===i.find("a:first")[0].href?i.find("a:first").trigger("click",t):i.find("a:first")[0].click():this.node.closest("form").trigger("submit"));if(39===t.keyCode)return void(null!==n?e.eq(n).find("a:first")[0].click():this.options.hint&&""!==this.hint.container.val()&&this.helper.getCaret(this.node[0])>=this.query.length&&e.filter('[data-index="'+this.hintIndex+'"]').find("a:first")[0].click());9===t.keyCode?this.options.blurOnTab?this.hideLayout():i.length>0?n+1<e.length?(t.preventDefault(),r=n+1,this.addActiveItem(e.eq(r))):this.hideLayout():e.length?(t.preventDefault(),r=0,this.addActiveItem(e.first())):this.hideLayout():38===t.keyCode?(t.preventDefault(),i.length>0?n-1>=0&&(r=n-1,this.addActiveItem(e.eq(r))):e.length&&(r=e.length-1,this.addActiveItem(e.last()))):40===t.keyCode&&(t.preventDefault(),i.length>0?n+1<e.length&&(r=n+1,this.addActiveItem(e.eq(r))):e.length&&(r=0,this.addActiveItem(e.first()))),o=null!==r?e.eq(r).attr("data-index"):null,this.helper.executeCallback.call(this,this.options.callback.onEnter,[this.node,null!==r&&e.eq(r)||void 0,null!==o&&this.result[o]||void 0,t]),t.preventInputChange&&~[38,40].indexOf(t.keyCode)&&this.buildHintLayout(null!==o&&o<this.result.length?[this.result[o]]:null),this.options.hint&&this.hint.container&&this.hint.container.css("color",t.preventInputChange?this.hint.css.color:null===o&&this.hint.css.color||this.hint.container.css("background-color")||"fff");var a=null===o||t.preventInputChange?this.rawQuery:this.getTemplateValue.call(this,this.result[o]);this.node.val(a),this.isContentEditable&&this.node.text(a),this.helper.executeCallback.call(this,this.options.callback.onNavigateAfter,[this.node,e,null!==r&&e.eq(r).find("a:first")||void 0,null!==o&&this.result[o]||void 0,this.query,t])}},getTemplateValue:function(t){if(t){var e=t.group&&this.options.source[t.group].templateValue||this.options.templateValue;if("function"==typeof e&&(e=e.call(this)),!e)return this.helper.namespace.call(this,t.matchedKey,t).toString();var i=this;return e.replace(/\{\{([\w\-.]+)}}/gi,function(e,n){return i.helper.namespace.call(i,n,t,"get","")})}},clearActiveItem:function(){this.resultContainer.find("."+this.options.selector.item).removeClass("active")},addActiveItem:function(t){t.addClass("active")},searchResult:function(){this.resetLayout(),!1!==this.helper.executeCallback.call(this,this.options.callback.onSearch,[this.node,this.query])&&(!this.searchGroups.length||this.options.multiselect&&this.options.multiselect.limit&&this.items.length>=this.options.multiselect.limit||this.searchResultData(),this.helper.executeCallback.call(this,this.options.callback.onResult,[this.node,this.query,this.result,this.resultCount,this.resultCountPerGroup]),this.isDropdownEvent&&(this.helper.executeCallback.call(this,this.options.callback.onDropdownFilter,[this.node,this.query,this.filters.dropdown,this.result]),this.isDropdownEvent=!1))},searchResultData:function(){var e,i,n,s,r,o,a,l,u,h,c,d,p,f=this,g=this.groupBy,m=null,y=this.query.toLowerCase(),v=this.options.maxItem,b=this.options.maxItemPerGroup,_=this.filters.dynamic&&!this.helper.isEmpty(this.filters.dynamic),w="function"==typeof this.options.matcher&&this.options.matcher;this.options.accent&&(y=this.helper.removeAccent.call(this,y));for(var C=0,k=this.searchGroups.length;k>C;++C)if(e=this.searchGroups[C],!this.filters.dropdown||"group"!==this.filters.dropdown.key||this.filters.dropdown.value===e){a=void 0!==this.options.source[e].filter?this.options.source[e].filter:this.options.filter,u="function"==typeof this.options.source[e].matcher&&this.options.source[e].matcher||w;for(var A=0,E=this.source[e].length;E>A&&(!(this.resultItemCount>=v)||this.options.callback.onResult);A++)if((!_||this.dynamicFilter.validate.apply(this,[this.source[e][A]]))&&null!==(i=this.source[e][A])&&"boolean"!=typeof i&&(!this.options.multiselect||this.isMultiselectUniqueData(i))&&(!this.filters.dropdown||(i[this.filters.dropdown.key]||"").toLowerCase()===(this.filters.dropdown.value||"").toLowerCase())){if(m="group"===g?e:i[g]?i[g]:i.group,m&&!this.tmpResult[m]&&(this.tmpResult[m]=[],this.resultCountPerGroup[m]=0),b&&"group"===g&&this.tmpResult[m].length>=b&&!this.options.callback.onResult)break;r=this.options.source[e].display||this.options.display;for(var x=0,S=r.length;S>x;++x){if(!1!==a){if(void 0===(o=/\./.test(r[x])?this.helper.namespace.call(this,r[x],i):i[r[x]])||""===o)continue;o=this.helper.cleanStringFromScript(o)}if("function"==typeof a){if(void 0===(l=a.call(this,i,o)))break;if(!l)continue;"object"==typeof l&&(i=l)}if(~[void 0,!0].indexOf(a)){if(s=o,s=s.toString().toLowerCase(),this.options.accent&&(s=this.helper.removeAccent.call(this,s)),n=s.indexOf(y),this.options.correlativeTemplate&&"compiled"===r[x]&&0>n&&/\s/.test(y)){c=!0,d=y.split(" "),p=s;for(var F=0,O=d.length;O>F;F++)if(""!==d[F]){if(!~p.indexOf(d[F])){c=!1;break}p=p.replace(d[F],"")}}if(0>n&&!c)continue;if(this.options.offset&&0!==n)continue;if(u){if(void 0===(h=u.call(this,i,o)))break;if(!h)continue;"object"==typeof h&&(i=h)}}if(this.resultCount++,this.resultCountPerGroup[m]++,this.resultItemCount<v){if(b&&this.tmpResult[m].length>=b)break;this.tmpResult[m].push(t.extend(!0,{matchedKey:r[x]},i)),this.resultItemCount++}break}if(!this.options.callback.onResult){if(this.resultItemCount>=v)break;if(b&&this.tmpResult[m].length>=b&&"group"===g)break}}}if(this.options.order){var T,r=[];for(var e in this.tmpResult)if(this.tmpResult.hasOwnProperty(e)){for(var C=0,k=this.tmpResult[e].length;k>C;C++)T=this.options.source[this.tmpResult[e][C].group].display||this.options.display,~r.indexOf(T[0])||r.push(T[0]);this.tmpResult[e].sort(f.helper.sort(r,"asc"===f.options.order,function(t){return t.toString().toUpperCase()}))}}var I=[],$=[];$="function"==typeof this.options.groupOrder?this.options.groupOrder.apply(this,[this.node,this.query,this.tmpResult,this.resultCount,this.resultCountPerGroup]):Array.isArray(this.options.groupOrder)?this.options.groupOrder:"string"==typeof this.options.groupOrder&&~["asc","desc"].indexOf(this.options.groupOrder)?Object.keys(this.tmpResult).sort(f.helper.sort([],"asc"===f.options.groupOrder,function(t){return t.toString().toUpperCase()})):Object.keys(this.tmpResult);for(var C=0,k=$.length;k>C;C++)I=I.concat(this.tmpResult[$[C]]||[]);this.groups=JSON.parse(JSON.stringify($)),this.result=I},buildLayout:function(){this.buildHtmlLayout(),this.buildBackdropLayout(),this.buildHintLayout(),this.options.callback.onLayoutBuiltBefore&&this.helper.executeCallback.call(this,this.options.callback.onLayoutBuiltBefore,[this.node,this.query,this.result,this.resultHtml]),this.resultHtml instanceof t&&this.resultContainer.html(this.resultHtml),this.options.callback.onLayoutBuiltAfter&&this.helper.executeCallback.call(this,this.options.callback.onLayoutBuiltAfter,[this.node,this.query,this.result])},buildHtmlLayout:function(){if(!1!==this.options.resultContainer){this.resultContainer||(this.resultContainer=t("<div/>",{class:this.options.selector.result}),this.container.append(this.resultContainer));var e;if(!this.result.length)if(this.options.multiselect&&this.options.multiselect.limit&&this.items.length>=this.options.multiselect.limit)e=this.options.multiselect.limitTemplate?"function"==typeof this.options.multiselect.limitTemplate?this.options.multiselect.limitTemplate.call(this,this.query):this.options.multiselect.limitTemplate.replace(/\{\{query}}/gi,t("<div>").text(this.helper.cleanStringFromScript(this.query)).html()):"Can't select more than "+this.items.length+" items.";else{if(!this.options.emptyTemplate||""===this.query)return;e="function"==typeof this.options.emptyTemplate?this.options.emptyTemplate.call(this,this.query):this.options.emptyTemplate.replace(/\{\{query}}/gi,t("<div>").text(this.helper.cleanStringFromScript(this.query)).html())}var i=this.query.toLowerCase();this.options.accent&&(i=this.helper.removeAccent.call(this,i));var n=this,s=this.groupTemplate||"<ul></ul>",r=!1;this.groupTemplate?s=t(s.replace(/<([^>]+)>\{\{(.+?)}}<\/[^>]+>/g,function(t,i,s,o,a){var l="",u="group"===s?n.groups:[s];if(!n.result.length)return!0===r?"":(r=!0,"<"+i+' class="'+n.options.selector.empty+'">'+e+"</"+i+">");for(var h=0,c=u.length;c>h;++h)l+="<"+i+' data-group-template="'+u[h]+'"><ul></ul></'+i+">";return l})):(s=t(s),this.result.length||s.append(e instanceof t?e:'<li class="'+n.options.selector.empty+'">'+e+"</li>")),s.addClass(this.options.selector.list+(this.helper.isEmpty(this.result)?" empty":""));for(var o,a,l,u,h,c,d,p,f,g,m,y=this.groupTemplate&&this.result.length&&n.groups||[],v=0,b=this.result.length;b>v;++v)l=this.result[v],o=l.group,u=!this.options.multiselect&&this.options.source[l.group].href||this.options.href,p=[],f=this.options.source[l.group].display||this.options.display,this.options.group&&(o=l[this.options.group.key],this.options.group.template&&("function"==typeof this.options.group.template?a=this.options.group.template.call(this,l):"string"==typeof this.options.group.template&&(a=this.options.group.template.replace(/\{\{([\w\-\.]+)}}/gi,function(t,e){return n.helper.namespace.call(n,e,l,"get","")}))),s.find('[data-search-group="'+o+'"]')[0]||(this.groupTemplate?s.find('[data-group-template="'+o+'"] ul'):s).append(t("<li/>",{class:n.options.selector.group,html:t("<a/>",{href:"javascript:;",html:a||o,tabindex:-1}),"data-search-group":o}))),this.groupTemplate&&y.length&&~(m=y.indexOf(o||l.group))&&y.splice(m,1),h=t("<li/>",{class:n.options.selector.item+" "+n.options.selector.group+"-"+this.helper.slugify.call(this,o),disabled:!!l.disabled,"data-group":o,"data-index":v,html:t("<a/>",{href:u&&!l.disabled?function(t,e){return e.href=n.generateHref.call(n,t,e)}(u,l):"javascript:;",html:function(){if(c=l.group&&n.options.source[l.group].template||n.options.template)"function"==typeof c&&(c=c.call(n,n.query,l)),d=c.replace(/\{\{([^\|}]+)(?:\|([^}]+))*}}/gi,function(t,e,s){var r=n.helper.cleanStringFromScript(String(n.helper.namespace.call(n,e,l,"get","")));return s=s&&s.split("|")||[],~s.indexOf("slugify")&&(r=n.helper.slugify.call(n,r)),~s.indexOf("raw")||!0===n.options.highlight&&i&&~f.indexOf(e)&&(r=n.helper.highlight.call(n,r,i.split(" "),n.options.accent)),r});else{for(var e=0,s=f.length;s>e;e++)void 0!==(g=/\./.test(f[e])?n.helper.namespace.call(n,f[e],l,"get",""):l[f[e]])&&""!==g&&p.push(g);d='<span class="'+n.options.selector.display+'">'+n.helper.cleanStringFromScript(String(p.join(" ")))+"</span>"}(!0===n.options.highlight&&i&&!c||"any"===n.options.highlight)&&(d=n.helper.highlight.call(n,d,i.split(" "),n.options.accent)),t(this).append(d)}})}),function(e,i,s){s.on("click",function(e,s){if(i.disabled)return void e.preventDefault();if(s&&"object"==typeof s&&(e.originalEvent=s),n.options.mustSelectItem&&n.helper.isEmpty(i))return void e.preventDefault();if(n.options.multiselect?(n.items.push(i),n.comparedItems.push(n.getMultiselectComparedData(i))):n.item=i,!1!==n.helper.executeCallback.call(n,n.options.callback.onClickBefore,[n.node,t(this),i,e])&&!(e.originalEvent&&e.originalEvent.defaultPrevented||e.isDefaultPrevented())){var r=n.getTemplateValue.call(n,i);n.options.multiselect?(n.query=n.rawQuery="",n.addMultiselectItemLayout(r)):(n.focusOnly=!0,n.query=n.rawQuery=r,n.isContentEditable&&(n.node.text(n.query),n.helper.setCaretAtEnd(n.node[0]))),n.hideLayout(),n.node.val(n.query).focus(),n.helper.executeCallback.call(n,n.options.callback.onClickAfter,[n.node,t(this),i,e])}}),s.on("mouseenter",function(e){i.disabled||(n.clearActiveItem(),n.addActiveItem(t(this))),n.helper.executeCallback.call(n,n.options.callback.onEnter,[n.node,t(this),i,e])}),s.on("mouseleave",function(e){i.disabled||n.clearActiveItem(),n.helper.executeCallback.call(n,n.options.callback.onLeave,[n.node,t(this),i,e])})}(0,l,h),(this.groupTemplate?s.find('[data-group-template="'+o+'"] ul'):s).append(h);if(this.result.length&&y.length)for(var v=0,b=y.length;b>v;++v)s.find('[data-group-template="'+y[v]+'"]').remove();this.resultHtml=s}},generateHref:function(t,e){var i=this;return"string"==typeof t?t=t.replace(/\{\{([^\|}]+)(?:\|([^}]+))*}}/gi,function(t,n,s){var r=i.helper.namespace.call(i,n,e,"get","");return s=s&&s.split("|")||[],~s.indexOf("slugify")&&(r=i.helper.slugify.call(i,r)),r}):"function"==typeof t&&(t=t.call(this,e)),t},getMultiselectComparedData:function(t){var e="";if(Array.isArray(this.options.multiselect.matchOn))for(var i=0,n=this.options.multiselect.matchOn.length;n>i;++i)e+=void 0!==t[this.options.multiselect.matchOn[i]]?t[this.options.multiselect.matchOn[i]]:"";else{for(var s=JSON.parse(JSON.stringify(t)),r=["group","matchedKey","compiled","href"],i=0,n=r.length;n>i;++i)delete s[r[i]];e=JSON.stringify(s)}return e},buildBackdropLayout:function(){this.options.backdrop&&(this.backdrop.container||(this.backdrop.css=t.extend({opacity:.6,filter:"alpha(opacity=60)",position:"fixed",top:0,right:0,bottom:0,left:0,"z-index":1040,"background-color":"#000"},this.options.backdrop),this.backdrop.container=t("<div/>",{class:this.options.selector.backdrop,css:this.backdrop.css}).insertAfter(this.container)),this.container.addClass("backdrop").css({"z-index":this.backdrop.css["z-index"]+1,position:"relative"}))},buildHintLayout:function(e){if(this.options.hint){if(this.node[0].scrollWidth>Math.ceil(this.node.innerWidth()))return void(this.hint.container&&this.hint.container.val(""));var i=this,n="",e=e||this.result,s=this.query.toLowerCase();if(this.options.accent&&(s=this.helper.removeAccent.call(this,s)),this.hintIndex=null,this.searchGroups.length){if(this.hint.container||(this.hint.css=t.extend({"border-color":"transparent",position:"absolute",top:0,display:"inline","z-index":-1,float:"none",color:"silver","box-shadow":"none",cursor:"default","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"},this.options.hint),this.hint.container=t("<"+this.node[0].nodeName+"/>",{type:this.node.attr("type"),class:this.node.attr("class"),readonly:!0,unselectable:"on","aria-hidden":"true",tabindex:-1,click:function(){i.node.focus()}}).addClass(this.options.selector.hint).css(this.hint.css).insertAfter(this.node),this.node.parent().css({position:"relative"})),this.hint.container.css("color",this.hint.css.color),s)for(var r,o,a,l=0,u=e.length;u>l;l++)if(!e[l].disabled){o=e[l].group,r=this.options.source[o].display||this.options.display;for(var h=0,c=r.length;c>h;h++)if(a=String(e[l][r[h]]).toLowerCase(),this.options.accent&&(a=this.helper.removeAccent.call(this,a)),0===a.indexOf(s)){n=String(e[l][r[h]]),this.hintIndex=l;break}if(null!==this.hintIndex)break}var d=n.length>0&&this.rawQuery+n.substring(this.query.length)||"";this.hint.container.val(d),this.isContentEditable&&this.hint.container.text(d)}}},buildDropdownLayout:function(){if(this.options.dropdownFilter){var e=this;t("<span/>",{class:this.options.selector.filter,html:function(){t(this).append(t("<button/>",{type:"button",class:e.options.selector.filterButton,style:"display: none;",click:function(){e.container.toggleClass("filter");var i=e.namespace+"-dropdown-filter";t("html").off(i),e.container.hasClass("filter")&&t("html").on("click"+i+" touchend"+i,function(n){t(n.target).closest("."+e.options.selector.filter)[0]&&t(n.target).closest(e.container)[0]||e.hasDragged||(e.container.removeClass("filter"),t("html").off(i))})}})),t(this).append(t("<ul/>",{class:e.options.selector.dropdown}))}}).insertAfter(e.container.find("."+e.options.selector.query))}},buildDropdownItemLayout:function(e){function i(t){"*"===t.value?delete this.filters.dropdown:this.filters.dropdown=t,this.container.removeClass("filter").find("."+this.options.selector.filterButton).html(t.template),this.isDropdownEvent=!0,this.node.trigger("search"+this.namespace),this.options.multiselect&&this.adjustInputSize(),this.node.focus()}if(this.options.dropdownFilter){var n,s,r=this,o="string"==typeof this.options.dropdownFilter&&this.options.dropdownFilter||"All",a=this.container.find("."+this.options.selector.dropdown);"static"!==e||!0!==this.options.dropdownFilter&&"string"!=typeof this.options.dropdownFilter||this.dropdownFilter.static.push({key:"group",template:"{{group}}",all:o,value:Object.keys(this.options.source)});for(var l=0,u=this.dropdownFilter[e].length;u>l;l++){s=this.dropdownFilter[e][l],Array.isArray(s.value)||(s.value=[s.value]),s.all&&(this.dropdownFilterAll=s.all);for(var h=0,c=s.value.length;c>=h;h++)(h!==c||l===u-1)&&(h===c&&l===u-1&&"static"===e&&this.dropdownFilter.dynamic.length||(n=this.dropdownFilterAll||o,s.value[h]?n=s.template?s.template.replace(new RegExp("{{"+s.key+"}}","gi"),s.value[h]):s.value[h]:this.container.find("."+r.options.selector.filterButton).html(n),function(e,n,s){a.append(t("<li/>",{class:r.options.selector.dropdownItem+" "+r.helper.slugify.call(r,n.key+"-"+(n.value[e]||o)),html:t("<a/>",{href:"javascript:;",html:s,click:function(t){t.preventDefault(),i.call(r,{key:n.key,value:n.value[e]||"*",template:s})}})}))}(h,s,n)))}this.dropdownFilter[e].length&&this.container.find("."+r.options.selector.filterButton).removeAttr("style")}},dynamicFilter:{isEnabled:!1,init:function(){this.options.dynamicFilter&&(this.dynamicFilter.bind.call(this),this.dynamicFilter.isEnabled=!0)},validate:function(t){var e,i,n=null,s=null;for(var r in this.filters.dynamic)if(this.filters.dynamic.hasOwnProperty(r)&&(i=~r.indexOf(".")?this.helper.namespace.call(this,r,t,"get"):t[r],"|"!==this.filters.dynamic[r].modifier||n||(n=i==this.filters.dynamic[r].value||!1),"&"===this.filters.dynamic[r].modifier)){if(i!=this.filters.dynamic[r].value){s=!1;break}s=!0}return e=n,null!==s&&(e=s,!0===s&&null!==n&&(e=n)),!!e},set:function(t,e){var i=t.match(/^([|&])?(.+)/);e?this.filters.dynamic[i[2]]={modifier:i[1]||"|",value:e}:delete this.filters.dynamic[i[2]],this.dynamicFilter.isEnabled&&this.generateSource()},bind:function(){for(var e,i=this,n=0,s=this.options.dynamicFilter.length;s>n;n++)e=this.options.dynamicFilter[n],"string"==typeof e.selector&&(e.selector=t(e.selector)),e.selector instanceof t&&e.selector[0]&&e.key&&function(t){t.selector.off(i.namespace).on("change"+i.namespace,function(){i.dynamicFilter.set.apply(i,[t.key,i.dynamicFilter.getValue(this)])}).trigger("change"+i.namespace)}(e)},getValue:function(t){var e;return"SELECT"===t.tagName?e=t.value:"INPUT"===t.tagName&&("checkbox"===t.type?e=t.checked&&t.getAttribute("value")||t.checked||null:"radio"===t.type&&t.checked&&(e=t.value)),e}},buildMultiselectLayout:function(){if(this.options.multiselect){var e,i=this;this.label.container=t("<span/>",{class:this.options.selector.labelContainer,"data-padding-left":parseFloat(this.node.css("padding-left"))||0,"data-padding-right":parseFloat(this.node.css("padding-right"))||0,"data-padding-top":parseFloat(this.node.css("padding-top"))||0,click:function(e){t(e.target).hasClass(i.options.selector.labelContainer)&&i.node.focus()}}),this.node.closest("."+this.options.selector.query).prepend(this.label.container),this.options.multiselect.data&&(Array.isArray(this.options.multiselect.data)?this.populateMultiselectData(this.options.multiselect.data):"function"==typeof this.options.multiselect.data&&(e=this.options.multiselect.data.call(this),Array.isArray(e)?this.populateMultiselectData(e):"function"==typeof e.promise&&t.when(e).then(function(t){t&&Array.isArray(t)&&i.populateMultiselectData(t)})))}},
isMultiselectUniqueData:function(t){for(var e=!0,i=0,n=this.comparedItems.length;n>i;++i)if(this.comparedItems[i]===this.getMultiselectComparedData(t)){e=!1;break}return e},populateMultiselectData:function(t){for(var e=0,i=t.length;i>e;++e)this.isMultiselectUniqueData(t[e])&&(this.items.push(t[e]),this.comparedItems.push(this.getMultiselectComparedData(t[e])),this.addMultiselectItemLayout(this.getTemplateValue(t[e])));this.node.trigger("search"+this.namespace,{origin:"populateMultiselectData"})},addMultiselectItemLayout:function(e){var i=this,n=this.options.multiselect.href?"a":"span",s=t("<span/>",{class:this.options.selector.label,html:t("<"+n+"/>",{text:e,click:function(e){var n=t(this).closest("."+i.options.selector.label),s=i.label.container.find("."+i.options.selector.label).index(n);i.options.multiselect.callback&&i.helper.executeCallback.call(i,i.options.multiselect.callback.onClick,[i.node,i.items[s],e])},href:this.options.multiselect.href?function(t){return i.generateHref.call(i,i.options.multiselect.href,t)}(i.items[i.items.length-1]):null})});s.append(t("<span/>",{class:this.options.selector.cancelButton,html:"",click:function(e){var n=t(this).closest("."+i.options.selector.label),s=i.label.container.find("."+i.options.selector.label).index(n);i.cancelMultiselectItem(s,n,e)}})),this.label.container.append(s),this.adjustInputSize()},cancelMultiselectItem:function(t,e,i){var n=this.items[t];e=e||this.label.container.find("."+this.options.selector.label).eq(t),e.remove(),this.items.splice(t,1),this.comparedItems.splice(t,1),this.options.multiselect.callback&&this.helper.executeCallback.call(this,this.options.multiselect.callback.onCancel,[this.node,n,i]),this.adjustInputSize(),this.focusOnly=!0,this.node.focus().trigger("input"+this.namespace,{origin:"cancelMultiselectItem"})},adjustInputSize:function(){var e=this.node[0].getBoundingClientRect().width-(parseFloat(this.label.container.data("padding-right"))||0)-(parseFloat(this.label.container.css("padding-left"))||0),i=0,n=0,s=0,r=!1,o=0;this.label.container.find("."+this.options.selector.label).filter(function(a,l){0===a&&(o=t(l)[0].getBoundingClientRect().height+parseFloat(t(l).css("margin-bottom")||0)),i=t(l)[0].getBoundingClientRect().width+parseFloat(t(l).css("margin-right")||0),s+i>.7*e&&!r&&(n++,r=!0),e>s+i?s+=i:(r=!1,s=i)});var a=parseFloat(this.label.container.data("padding-left")||0)+(r?0:s),l=n*o+parseFloat(this.label.container.data("padding-top")||0);this.container.find("."+this.options.selector.query).find("input, textarea, [contenteditable], .typeahead__hint").css({paddingLeft:a,paddingTop:l})},showLayout:function(){function e(){var e=this;t("html").off("keydown"+this.namespace).on("keydown"+this.namespace,function(i){i.keyCode&&9===i.keyCode&&setTimeout(function(){t(":focus").closest(e.container).find(e.node)[0]||e.hideLayout()},0)}),t("html").off("click"+this.namespace+" touchend"+this.namespace).on("click"+this.namespace+" touchend"+this.namespace,function(i){t(i.target).closest(e.container)[0]||t(i.target).closest("."+e.options.selector.item)[0]||i.target.className===e.options.selector.cancelButton||e.hasDragged||e.hideLayout()})}!this.container.hasClass("result")&&(this.result.length||this.options.emptyTemplate||this.options.backdropOnFocus)&&(e.call(this),this.container.addClass([this.result.length||this.searchGroups.length&&this.options.emptyTemplate&&this.query.length?"result ":"",this.options.hint&&this.searchGroups.length?"hint":"",this.options.backdrop||this.options.backdropOnFocus?"backdrop":""].join(" ")),this.helper.executeCallback.call(this,this.options.callback.onShowLayout,[this.node,this.query]))},hideLayout:function(){(this.container.hasClass("result")||this.container.hasClass("backdrop"))&&(this.container.removeClass("result hint filter"+(this.options.backdropOnFocus&&t(this.node).is(":focus")?"":" backdrop")),this.options.backdropOnFocus&&this.container.hasClass("backdrop")||(t("html").off(this.namespace),this.helper.executeCallback.call(this,this.options.callback.onHideLayout,[this.node,this.query])))},resetLayout:function(){this.result=[],this.tmpResult={},this.groups=[],this.resultCount=0,this.resultCountPerGroup={},this.resultItemCount=0,this.resultHtml=null,this.options.hint&&this.hint.container&&(this.hint.container.val(""),this.isContentEditable&&this.hint.container.text(""))},resetInput:function(){this.node.val(""),this.isContentEditable&&this.node.text(""),this.item=null,this.query="",this.rawQuery=""},buildCancelButtonLayout:function(){if(this.options.cancelButton){var e=this;t("<span/>",{class:this.options.selector.cancelButton,html:"",mousedown:function(t){t.stopImmediatePropagation(),t.preventDefault(),e.resetInput(),e.node.trigger("input"+e.namespace,[t])}}).insertBefore(this.node)}},toggleCancelButtonVisibility:function(){this.container.toggleClass("cancel",!!this.query.length)},__construct:function(){this.extendOptions(),this.unifySourceFormat()&&(this.dynamicFilter.init.apply(this),this.init(),this.buildDropdownLayout(),this.buildDropdownItemLayout("static"),this.buildMultiselectLayout(),this.delegateEvents(),this.buildCancelButtonLayout(),this.helper.executeCallback.call(this,this.options.callback.onReady,[this.node]))},helper:{isEmpty:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},removeAccent:function(t){if("string"==typeof t){var e=i;return"object"==typeof this.options.accent&&(e=this.options.accent),t=t.toLowerCase().replace(new RegExp("["+e.from+"]","g"),function(t){return e.to[e.from.indexOf(t)]})}},slugify:function(t){return t=String(t),""!==t&&(t=this.helper.removeAccent.call(this,t),t=t.replace(/[^-a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")),t},sort:function(t,e,i){var n=function(e){for(var n=0,s=t.length;s>n;n++)if(void 0!==e[t[n]])return i(e[t[n]]);return e};return e=[-1,1][+!!e],function(t,i){return t=n(t),i=n(i),e*((t>i)-(i>t))}},replaceAt:function(t,e,i,n){return t.substring(0,e)+n+t.substring(e+i)},highlight:function(t,e,i){t=String(t);var n=i&&this.helper.removeAccent.call(this,t)||t,s=[];Array.isArray(e)||(e=[e]),e.sort(function(t,e){return e.length-t.length});for(var r=e.length-1;r>=0;r--)""!==e[r].trim()?e[r]=e[r].replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e.splice(r,1);n.replace(new RegExp("(?:"+e.join("|")+")(?!([^<]+)?>)","gi"),function(t,e,i){s.push({offset:i,length:t.length})});for(var r=s.length-1;r>=0;r--)t=this.helper.replaceAt(t,s[r].offset,s[r].length,"<strong>"+t.substr(s[r].offset,s[r].length)+"</strong>");return t},getCaret:function(t){var e=0;if(t.selectionStart)return t.selectionStart;if(document.selection){var i=document.selection.createRange();if(null===i)return e;var n=t.createTextRange(),s=n.duplicate();n.moveToBookmark(i.getBookmark()),s.setEndPoint("EndToStart",n),e=s.text.length}else if(window.getSelection){var r=window.getSelection();if(r.rangeCount){var o=r.getRangeAt(0);o.commonAncestorContainer.parentNode==t&&(e=o.endOffset)}}return e},setCaretAtEnd:function(t){if(void 0!==window.getSelection&&void 0!==document.createRange){var e=document.createRange();e.selectNodeContents(t),e.collapse(!1);var i=window.getSelection();i.removeAllRanges(),i.addRange(e)}else if(void 0!==document.body.createTextRange){var n=document.body.createTextRange();n.moveToElementText(t),n.collapse(!1),n.select()}},cleanStringFromScript:function(t){return"string"==typeof t&&t.replace(/<\/?(?:script|iframe)\b[^>]*>/gm,"")||t},executeCallback:function(t,e){if(t){var i;if("function"==typeof t)i=t;else if(("string"==typeof t||Array.isArray(t))&&("string"==typeof t&&(t=[t,[]]),"function"!=typeof(i=this.helper.namespace.call(this,t[0],window))))return;return i.apply(this,(t[1]||[]).concat(e||[]))}},namespace:function(t,e,i,n){if("string"!=typeof t||""===t)return!1;var s=void 0!==n?n:void 0;if(!~t.indexOf("."))return e[t]||s;for(var r=t.split("."),o=e||window,i=i||"get",a="",l=0,u=r.length;u>l;l++){if(a=r[l],void 0===o[a]){if(~["get","delete"].indexOf(i))return void 0!==n?n:void 0;o[a]={}}if(~["set","create","delete"].indexOf(i)&&l===u-1){if("set"!==i&&"create"!==i)return delete o[a],!0;o[a]=s}o=o[a]}return o},typeWatch:function(){var t=0;return function(e,i){clearTimeout(t),t=setTimeout(e,i)}}()}},t.fn.typeahead=t.typeahead=function(t){return a.typeahead(this,t)};var a={typeahead:function(e,i){if(i&&i.source&&"object"==typeof i.source){if("function"==typeof e){if(!i.input)return;e=t(i.input)}if(void 0===e[0].value&&(e[0].value=e.text()),e.length){if(1===e.length)return e[0].selector=e.selector||i.input||e[0].nodeName.toLowerCase(),window.Typeahead[e[0].selector]=new o(e,i);for(var n,s={},r=0,a=e.length;a>r;++r)n=e[r].nodeName.toLowerCase(),void 0!==s[n]&&(n+=r),e[r].selector=n,window.Typeahead[n]=s[n]=new o(e.eq(r),i);return s}}}};return window.console=window.console||{log:function(){}},Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),"indexOf"in Array.prototype||(Array.prototype.indexOf=function(t,e){void 0===e&&(e=0),0>e&&(e+=this.length),0>e&&(e=0);for(var i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1}),Object.keys||(Object.keys=function(t){var e,i=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&i.push(e);return i}),o});